\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{DecisionTree\_IDS}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{modelling-intrusion-detection-analysis-of-a-feature-selection-mechanism}{%
\section{Modelling Intrusion Detection: Analysis of a Feature Selection
Mechanism}\label{modelling-intrusion-detection-analysis-of-a-feature-selection-mechanism}}

\hypertarget{method-description}{%
\subsection{Method Description}\label{method-description}}

\hypertarget{step-1-data-preprocessing}{%
\subsubsection{Step 1: Data
preprocessing:}\label{step-1-data-preprocessing}}

All features are made numerical using one-Hot-encoding. The features are
scaled to avoid features with large values that may weigh too much in
the results.

\hypertarget{step-2-feature-selection}{%
\subsubsection{Step 2: Feature
Selection:}\label{step-2-feature-selection}}

Eliminate redundant and irrelevant data by selecting a subset of
relevant features that fully represents the given problem. Univariate
feature selection with ANOVA F-test. This analyzes each feature
individually to detemine the strength of the relationship between the
feature and labels. Using SecondPercentile method
(sklearn.feature\_selection) to select features based on percentile of
the highest scores. When this subset is found: Recursive Feature
Elimination (RFE) is applied.

\hypertarget{step-4-build-the-model}{%
\subsubsection{Step 4: Build the model:}\label{step-4-build-the-model}}

Decision tree model is built.

\hypertarget{step-5-prediction-evaluation-validation}{%
\subsubsection{Step 5: Prediction \& Evaluation
(validation):}\label{step-5-prediction-evaluation-validation}}

Using the test data to make predictions of the model. Multiple scores
are considered such as:accuracy score, recall, f-measure, confusion
matrix. perform a 10-fold cross-validation.

    \hypertarget{version-check}{%
\subsection{Version Check}\label{version-check}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{sys}
\PY{k+kn}{import} \PY{n+nn}{sklearn}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sys}\PY{o}{.}\PY{n}{version}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sklearn}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
1.2.5
1.17.4
3.8.5 (default, May 27 2021, 13:30:53)
[GCC 9.3.0]
0.24.2
    \end{Verbatim}

    \hypertarget{creating-datasets}{%
\subsection{Creating Datasets}\label{creating-datasets}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} loading every parts and concat them}
\PY{n}{files} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Friday\PYZhy{}WorkingHours\PYZhy{}Afternoon\PYZhy{}DDos.pcap\PYZus{}ISCX.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Friday\PYZhy{}WorkingHours\PYZhy{}Afternoon\PYZhy{}PortScan.pcap\PYZus{}ISCX.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
         \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Thursday\PYZhy{}WorkingHours\PYZhy{}Afternoon\PYZhy{}Infilteration.pcap\PYZus{}ISCX.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
         \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Thursday\PYZhy{}WorkingHours\PYZhy{}Morning\PYZhy{}WebAttacks.pcap\PYZus{}ISCX.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Friday\PYZhy{}WorkingHours\PYZhy{}Morning.pcap\PYZus{}ISCX.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
         \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Tuesday\PYZhy{}WorkingHours.pcap\PYZus{}ISCX.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Wednesday\PYZhy{}workingHours.pcap\PYZus{}ISCX.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{}combine all files in the list}
\PY{n}{combined\PYZus{}csv} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{n}{f}\PY{p}{)} \PY{k}{for} \PY{n}{f} \PY{o+ow}{in} \PY{n}{files}\PY{p}{]}\PY{p}{)}

\PY{c+c1}{\PYZsh{} drop entries with NaN values}
\PY{n}{combined\PYZus{}csv}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} drop entriers with values greater than max float}
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{combined\PYZus{}csv}\PY{o}{.}\PY{n}{columns}\PY{p}{:} 
        \PY{k}{if}\PY{p}{(}\PY{n}{col} \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{p}{:} \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Ignored column Label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        
        \PY{k}{else} \PY{p}{:} \PY{n}{combined\PYZus{}csv} \PY{o}{=} \PY{n}{combined\PYZus{}csv}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{(}\PY{n}{combined\PYZus{}csv}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{\PYZlt{}} \PY{n}{np}\PY{o}{.}\PY{n}{finfo}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{float64}\PY{p}{)}\PY{o}{.}\PY{n}{max} \PY{p}{)}\PY{p}{]}

\PY{c+c1}{\PYZsh{} shuffle data}
\PY{n}{combined\PYZus{}csv} \PY{o}{=} \PY{n}{combined\PYZus{}csv}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} slice into train and test data sets}
\PY{n}{chunk} \PY{o}{=} \PY{n+nb}{int} \PY{p}{(}\PY{n}{combined\PYZus{}csv}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{o}{*}\PY{l+m+mi}{75}\PY{o}{/}\PY{l+m+mi}{100}\PY{p}{)}  \PY{c+c1}{\PYZsh{}ratio = 75 \PYZpc{}  /  25\PYZpc{} }
\PY{n}{train\PYZus{}set} \PY{o}{=}\PY{n}{combined\PYZus{}csv}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{p}{:}\PY{n}{chunk}\PY{p}{,}\PY{p}{:}\PY{p}{]}
\PY{n}{test\PYZus{}set} \PY{o}{=} \PY{n}{combined\PYZus{}csv}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{n}{chunk}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{]}

\PY{c+c1}{\PYZsh{} exporting data sets}
\PY{n}{train\PYZus{}set}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train\PYZus{}IDS2017.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\PY{n}{test\PYZus{}set}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test\PYZus{}IDS2017.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Ignored column Label
    \end{Verbatim}

    \hypertarget{load-the-dataset}{%
\subsection{Load the Dataset}\label{load-the-dataset}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} train\PYZus{}IDS2017 \PYZam{} test\PYZus{}IDS2017 are the datafiles}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{train\PYZus{}IDS2017.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n}{df\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{test\PYZus{}IDS2017.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}

\PY{c+c1}{\PYZsh{} shape, this gives the dimensions of the dataset}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of the Training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of the Test set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Dimensions of the Training set: (1723796, 79)
Dimensions of the Test set: (574599, 79)
    \end{Verbatim}

    \hypertarget{sample-view-of-the-training-dataset}{%
\subsection{Sample view of the training
dataset}\label{sample-view-of-the-training-dataset}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} first five rows}
\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
    Destination Port   Flow Duration   Total Fwd Packets  \textbackslash{}
0              39344         5322068                   1
1                 80        81193164                   7
2                 80         5212710                   5
3                 80           62812                   3
4                123           16517                   1

    Total Backward Packets  Total Length of Fwd Packets  \textbackslash{}
0                        6                            6
1                        7                          372
2                        7                          256
3                        5                          351
4                        1                           48

    Total Length of Bwd Packets   Fwd Packet Length Max  \textbackslash{}
0                            36                       6
1                         11595                     348
2                          6945                     256
3                         11595                     351
4                            48                      48

    Fwd Packet Length Min   Fwd Packet Length Mean   Fwd Packet Length Std  \textbackslash{}
0                       6                 6.000000                0.000000
1                       0                53.142857              130.050540
2                       0                51.200000              114.486680
3                       0               117.000000              202.649945
4                      48                48.000000                0.000000

   {\ldots}   min\_seg\_size\_forward  Active Mean   Active Std   Active Max  \textbackslash{}
0  {\ldots}                     20      14199.0          0.0        14199
1  {\ldots}                     20       9298.0          0.0         9298
2  {\ldots}                     20          0.0          0.0            0
3  {\ldots}                     32          0.0          0.0            0
4  {\ldots}                     20          0.0          0.0            0

    Active Min   Idle Mean   Idle Std   Idle Max   Idle Min     Label
0        14199   5307869.0        0.0    5307869    5307869    BENIGN
1         9298  81000000.0        0.0   81000000   81000000  DoS Hulk
2            0         0.0        0.0          0          0    BENIGN
3            0         0.0        0.0          0          0  DoS Hulk
4            0         0.0        0.0          0          0    BENIGN

[5 rows x 79 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{statistical-summary}{%
\subsection{Statistical Summary}\label{statistical-summary}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
        Destination Port   Flow Duration   Total Fwd Packets  \textbackslash{}
count       1.723796e+06    1.723796e+06        1.723796e+06
mean        7.470606e+03    1.583614e+07        9.351395e+00
std         1.742827e+04    3.464414e+07        7.321452e+02
min         0.000000e+00   -1.300000e+01        1.000000e+00
25\%         5.300000e+01    1.490000e+02        1.000000e+00
50\%         8.000000e+01    3.137400e+04        2.000000e+00
75\%         4.430000e+02    4.679360e+06        5.000000e+00
max         6.553300e+04    1.200000e+08        2.079640e+05

        Total Backward Packets  Total Length of Fwd Packets  \textbackslash{}
count             1.723796e+06                 1.723796e+06
mean              1.042810e+01                 5.469494e+02
std               9.753259e+02                 6.015465e+03
min               0.000000e+00                 0.000000e+00
25\%               1.000000e+00                 6.000000e+00
50\%               2.000000e+00                 6.000000e+01
75\%               4.000000e+00                 1.880000e+02
max               2.846020e+05                 2.321478e+06

        Total Length of Bwd Packets   Fwd Packet Length Max  \textbackslash{}
count                  1.723796e+06            1.723796e+06
mean                   1.650805e+04            2.117098e+02
std                    2.232356e+06            7.653291e+02
min                    0.000000e+00            0.000000e+00
25\%                    2.000000e+00            6.000000e+00
50\%                    1.200000e+02            3.600000e+01
75\%                    5.680000e+02            8.200000e+01
max                    6.270000e+08            2.482000e+04

        Fwd Packet Length Min   Fwd Packet Length Mean  \textbackslash{}
count            1.723796e+06             1.723796e+06
mean             1.833571e+01             5.999579e+01
std              6.442765e+01             2.018646e+02
min              0.000000e+00             0.000000e+00
25\%              0.000000e+00             6.000000e+00
50\%              2.000000e+00             3.300000e+01
75\%              3.500000e+01             4.942857e+01
max              2.325000e+03             5.940857e+03

        Fwd Packet Length Std  {\ldots}   act\_data\_pkt\_fwd   min\_seg\_size\_forward  \textbackslash{}
count            1.723796e+06  {\ldots}       1.723796e+06           1.723796e+06
mean             7.166455e+01  {\ldots}       5.092346e+00          -2.776945e+03
std              3.038700e+02  {\ldots}       5.884400e+02           1.226724e+06
min              0.000000e+00  {\ldots}       0.000000e+00          -5.368707e+08
25\%              0.000000e+00  {\ldots}       0.000000e+00           2.000000e+01
50\%              0.000000e+00  {\ldots}       1.000000e+00           2.400000e+01
75\%              2.327660e+01  {\ldots}       2.000000e+00           3.200000e+01
max              7.049469e+03  {\ldots}       1.986360e+05           1.380000e+02

        Active Mean    Active Std    Active Max    Active Min     Idle Mean  \textbackslash{}
count  1.723796e+06  1.723796e+06  1.723796e+06  1.723796e+06  1.723796e+06
mean   8.467509e+04  4.063266e+04  1.548646e+05  6.169928e+04  9.461003e+06
std    6.629659e+05  3.943243e+05  1.025116e+06  5.936543e+05  2.536225e+07
min    0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
25\%    0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
50\%    0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
75\%    0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
max    1.100000e+08  7.420000e+07  1.100000e+08  1.100000e+08  1.200000e+08

           Idle Std      Idle Max      Idle Min
count  1.723796e+06  1.723796e+06  1.723796e+06
mean   5.736089e+05  9.892166e+06  9.017300e+06
std    4.998360e+06  2.614349e+07  2.509603e+07
min    0.000000e+00  0.000000e+00  0.000000e+00
25\%    0.000000e+00  0.000000e+00  0.000000e+00
50\%    0.000000e+00  0.000000e+00  0.000000e+00
75\%    0.000000e+00  0.000000e+00  0.000000e+00
max    7.690000e+07  1.200000e+08  1.200000e+08

[8 rows x 78 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{label-distribution-of-training-and-test-set}{%
\subsection{Label Distribution of Training and Test
set}\label{label-distribution-of-training-and-test-set}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Label distribution Training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Label distribution Test set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Label distribution Training set:
BENIGN                        1306151
DoS Hulk                       172736
PortScan                       119174
DDoS                            96060
DoS GoldenEye                    7760
FTP-Patator                      5967
SSH-Patator                      4382
DoS slowloris                    4378
DoS Slowhttptest                 4064
Bot                              1460
Web Attack � Brute Force         1115
Web Attack � XSS                  501
Infiltration                       25
Web Attack � Sql Injection         14
Heartbleed                          9
Name:  Label, dtype: int64

Label distribution Test set:
BENIGN                        435688
DoS Hulk                       57388
PortScan                       39630
DDoS                           31965
DoS GoldenEye                   2533
FTP-Patator                     1968
SSH-Patator                     1515
DoS Slowhttptest                1435
DoS slowloris                   1418
Bot                              496
Web Attack � Brute Force         392
Web Attack � XSS                 151
Infiltration                      11
Web Attack � Sql Injection         7
Heartbleed                         2
Name:  Label, dtype: int64
    \end{Verbatim}

    \hypertarget{removing-700k-benign-from-training-set}{%
\subsection{Removing 700k BENIGN from training
set}\label{removing-700k-benign-from-training-set}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} shuffle entries}
\PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} removing the first 700k}
\PY{n}{c} \PY{o}{=} \PY{l+m+mi}{0}
\PY{n}{to\PYZus{}remove} \PY{o}{=} \PY{p}{[}\PY{p}{]}
\PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{row} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{iterrows}\PY{p}{(}\PY{p}{)}\PY{p}{:}
    \PY{k}{if} \PY{p}{(}\PY{n}{c} \PY{o}{\PYZlt{}} \PY{l+m+mi}{700000}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{row}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}  \PY{o}{==} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{BENIGN}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{:}
        \PY{n}{to\PYZus{}remove}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{i}\PY{p}{)}
        \PY{n}{c} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
    \PY{k}{elif} \PY{p}{(}\PY{n}{c} \PY{o}{\PYZgt{}}\PY{o}{=} \PY{l+m+mi}{700000}\PY{p}{)}\PY{p}{:}
        \PY{k}{break}

\PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{to\PYZus{}remove}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}

\PY{c+c1}{\PYZsh{} shuffle entries}
\PY{n}{df} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n}{frac}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{n}{drop}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Label distribution Training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Label distribution Training set:
BENIGN                        606151
DoS Hulk                      172736
PortScan                      119174
DDoS                           96060
DoS GoldenEye                   7760
FTP-Patator                     5967
SSH-Patator                     4382
DoS slowloris                   4378
DoS Slowhttptest                4064
Bot                             1460
Web Attack � Brute Force        1115
Web Attack � XSS                 501
Infiltration                      25
Web Attack � Sql Injection        14
Heartbleed                         9
Name:  Label, dtype: int64
    \end{Verbatim}

    \hypertarget{step-1-data-preprocessing}{%
\section{Step 1: Data preprocessing:}\label{step-1-data-preprocessing}}

    \hypertarget{split-dataset-into-4-datasets-for-every-attack-category}{%
\section{Split Dataset into 4 datasets for every attack
category}\label{split-dataset-into-4-datasets-for-every-attack-category}}

\hypertarget{rename-every-attack-label-0normal-1dos-2probe-3web-and-4infil.}{%
\subsection{Rename every attack label: 0=normal, 1=DoS, 2=Probe, 3=Web
and
4=Infil.}\label{rename-every-attack-label-0normal-1dos-2probe-3web-and-4infil.}}

\hypertarget{replace-labels-column-with-new-labels-column}{%
\subsection{Replace labels column with new labels
column}\label{replace-labels-column-with-new-labels-column}}

\hypertarget{make-new-datasets}{%
\subsection{Make new datasets}\label{make-new-datasets}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} take label column}
\PY{n}{labeldf}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{labeldf\PYZus{}test}\PY{o}{=}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{c+c1}{\PYZsh{} change the label column}
\PY{n}{newlabeldf}\PY{o}{=}\PY{n}{labeldf}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{\PYZob{}} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BENIGN}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DDoS}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS Hulk}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS GoldenEye}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS slowloris}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}
                            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS Slowhttptest}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Bot}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PortScan}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Web Attack � Brute Force}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Web Attack � XSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Web Attack � Sql Injection}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Infiltration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{FTP\PYZhy{}Patator}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{SSH\PYZhy{}Patator}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Heartbleed}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{4}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{newlabeldf\PYZus{}test}\PY{o}{=}\PY{n}{labeldf\PYZus{}test}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{\PYZob{}} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{BENIGN}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{DDoS}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS Hulk}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS GoldenEye}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS slowloris}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}
                            \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS Slowhttptest}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Bot}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PortScan}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Web Attack � Brute Force}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Web Attack � XSS}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Web Attack � Sql Injection}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}
                            \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Infiltration}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{FTP\PYZhy{}Patator}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{SSH\PYZhy{}Patator}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Heartbleed}\PY{l+s+s2}{\PYZdq{}} \PY{p}{:} \PY{l+m+mi}{4}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} put the new label column back}
\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{newlabeldf}
\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{newlabeldf\PYZus{}test}

\PY{c+c1}{\PYZsh{} Printing labels to check every old label was assign a category}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Label distribution Training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Label distribution Test set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Label distribution Training set:
0    606151
1    286458
2    119174
4     10383
3      1630
Name:  Label, dtype: int64

Label distribution Test set:
0    435688
1     95235
2     39630
4      3496
3       550
Name:  Label, dtype: int64
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{38}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{to\PYZus{}drop\PYZus{}DoS} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{]}
\PY{n}{to\PYZus{}drop\PYZus{}Probe} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{]}
\PY{n}{to\PYZus{}drop\PYZus{}Web} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{]}
\PY{n}{to\PYZus{}drop\PYZus{}Infil} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}
\PY{n}{DoS\PYZus{}df}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}DoS}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{Probe\PYZus{}df}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}Probe}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{Web\PYZus{}df}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}Web}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{Infil\PYZus{}df}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}Infil}\PY{p}{)}\PY{p}{]}\PY{p}{;}

\PY{c+c1}{\PYZsh{}test}
\PY{n}{DoS\PYZus{}df\PYZus{}test}\PY{o}{=}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}DoS}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{Probe\PYZus{}df\PYZus{}test}\PY{o}{=}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}Probe}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{Web\PYZus{}df\PYZus{}test}\PY{o}{=}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}Web}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{Infil\PYZus{}df\PYZus{}test}\PY{o}{=}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}Infil}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of DoS:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{DoS\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of Probe:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{Probe\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of Web:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{Web\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of Infil:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{Infil\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of DoS:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{DoS\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of Probe:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{Probe\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of Web:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{Web\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of Infil:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{Infil\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Train:
Dimensions of DoS: (892609, 79)
Dimensions of Probe: (725325, 79)
Dimensions of Web: (607781, 79)
Dimensions of Infil: (616534, 79)
Test:
Dimensions of DoS: (530923, 79)
Dimensions of Probe: (475318, 79)
Dimensions of Web: (436238, 79)
Dimensions of Infil: (439184, 79)
    \end{Verbatim}

    \hypertarget{step-2-feature-scaling}{%
\section{Step 2: Feature Scaling:}\label{step-2-feature-scaling}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{39}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Split dataframes into X \PYZam{} Y}
\PY{c+c1}{\PYZsh{} assign X as a dataframe of feautures and Y as a series of outcome variables}
\PY{n}{X\PYZus{}DoS} \PY{o}{=} \PY{n}{DoS\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}DoS} \PY{o}{=} \PY{n}{DoS\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{X\PYZus{}Probe} \PY{o}{=} \PY{n}{Probe\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}Probe} \PY{o}{=} \PY{n}{Probe\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{X\PYZus{}Web} \PY{o}{=} \PY{n}{Web\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}Web} \PY{o}{=} \PY{n}{Web\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{X\PYZus{}Infil} \PY{o}{=} \PY{n}{Infil\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}Infil} \PY{o}{=} \PY{n}{Infil\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{c+c1}{\PYZsh{} test set}
\PY{n}{X\PYZus{}DoS\PYZus{}test} \PY{o}{=} \PY{n}{DoS\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}DoS\PYZus{}test} \PY{o}{=} \PY{n}{DoS\PYZus{}df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{X\PYZus{}Probe\PYZus{}test} \PY{o}{=} \PY{n}{Probe\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}Probe\PYZus{}test} \PY{o}{=} \PY{n}{Probe\PYZus{}df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{X\PYZus{}Web\PYZus{}test} \PY{o}{=} \PY{n}{Web\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}Web\PYZus{}test} \PY{o}{=} \PY{n}{Web\PYZus{}df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{X\PYZus{}Infil\PYZus{}test} \PY{o}{=} \PY{n}{Infil\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}Infil\PYZus{}test} \PY{o}{=} \PY{n}{Infil\PYZus{}df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ Label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{save-a-list-of-feature-names-for-later-use-it-is-the-same-for-every-attack-category.-column-names-are-dropped-at-this-stage.}{%
\subsubsection{Save a list of feature names for later use (it is the
same for every attack category). Column names are dropped at this
stage.}\label{save-a-list-of-feature-names-for-later-use-it-is-the-same-for-every-attack-category.-column-names-are-dropped-at-this-stage.}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{40}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{colNames}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{)}
\PY{n}{colNames\PYZus{}test}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{use-standardscaler-to-scale-the-dataframes}{%
\subsection{Use StandardScaler() to scale the
dataframes}\label{use-standardscaler-to-scale-the-dataframes}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{preprocessing}
\PY{n}{scaler1} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{)}
\PY{n}{X\PYZus{}DoS}\PY{o}{=}\PY{n}{scaler1}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{)} 
\PY{n}{scaler2} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{)}
\PY{n}{X\PYZus{}Probe}\PY{o}{=}\PY{n}{scaler2}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{)} 
\PY{n}{scaler3} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Web}\PY{p}{)}
\PY{n}{X\PYZus{}Web}\PY{o}{=}\PY{n}{scaler3}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Web}\PY{p}{)} 
\PY{n}{scaler4} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Infil}\PY{p}{)}
\PY{n}{X\PYZus{}Infil}\PY{o}{=}\PY{n}{scaler4}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Infil}\PY{p}{)} 
\PY{c+c1}{\PYZsh{} test data}
\PY{n}{scaler5} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}
\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{o}{=}\PY{n}{scaler5}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)} 
\PY{n}{scaler6} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{p}{)}
\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{o}{=}\PY{n}{scaler6}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{p}{)} 
\PY{n}{scaler7} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Web\PYZus{}test}\PY{p}{)}
\PY{n}{X\PYZus{}Web\PYZus{}test}\PY{o}{=}\PY{n}{scaler7}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Web\PYZus{}test}\PY{p}{)} 
\PY{n}{scaler8} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Infil\PYZus{}test}\PY{p}{)}
\PY{n}{X\PYZus{}Infil\PYZus{}test}\PY{o}{=}\PY{n}{scaler8}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Infil\PYZus{}test}\PY{p}{)} 
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{check-that-the-standard-deviation-is-1}{%
\subsubsection{Check that the Standard Deviation is
1}\label{check-that-the-standard-deviation-is-1}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 0. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1.]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}Probe}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{;}
\PY{n}{X\PYZus{}Web}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{;}
\PY{n}{X\PYZus{}Infil}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{step-3-feature-selection}{%
\section{Step 3: Feature Selection:}\label{step-3-feature-selection}}

    \hypertarget{univariate-feature-selection-using-anova-f-test}{%
\section{1. Univariate Feature Selection using ANOVA
F-test}\label{univariate-feature-selection-using-anova-f-test}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}univariate feature selection with ANOVA F\PYZhy{}test. using secondPercentile method, then RFE}
\PY{c+c1}{\PYZsh{}Scikit\PYZhy{}learn exposes feature selection routines as objects that implement the transform method}
\PY{c+c1}{\PYZsh{}SelectPercentile: removes all but a user\PYZhy{}specified highest scoring percentage of features}
\PY{c+c1}{\PYZsh{}f\PYZus{}classif: ANOVA F\PYZhy{}value between label/feature for classification tasks.}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k+kn}{import} \PY{n}{SelectPercentile}\PY{p}{,} \PY{n}{f\PYZus{}classif}
\PY{n}{np}\PY{o}{.}\PY{n}{seterr}\PY{p}{(}\PY{n}{divide}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{invalid}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\PY{n}{selector}\PY{o}{=}\PY{n}{SelectPercentile}\PY{p}{(}\PY{n}{f\PYZus{}classif}\PY{p}{,} \PY{n}{percentile}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
\PY{n}{X\PYZus{}newDoS} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{,}\PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n}{X\PYZus{}newDoS}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/infres/mhyounet/.local/lib/python3.8/site-
packages/sklearn/feature\_selection/\_univariate\_selection.py:114: UserWarning:
Features [31 33 56 57 58 59 60 61] are constant.
  warnings.warn("Features \%s are constant." \% constant\_features\_idx,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(892609, 8)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{get-the-features-that-were-selected-dos}{%
\subsubsection{Get the features that were selected:
DoS}\label{get-the-features-that-were-selected-dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{true}\PY{o}{=}\PY{n}{selector}\PY{o}{.}\PY{n}{get\PYZus{}support}\PY{p}{(}\PY{p}{)}
\PY{n}{newcolindex\PYZus{}DoS}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{newcolname\PYZus{}DoS}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(} \PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{newcolindex\PYZus{}DoS} \PY{p}{)}
\PY{n}{newcolname\PYZus{}DoS}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['Bwd Packet Length Max',
 ' Bwd Packet Length Mean',
 ' Bwd Packet Length Std',
 ' Max Packet Length',
 ' Packet Length Mean',
 ' Packet Length Std',
 ' Average Packet Size',
 ' Avg Bwd Segment Size']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}newProbe} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{,}\PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n}{X\PYZus{}newProbe}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/infres/mhyounet/.local/lib/python3.8/site-
packages/sklearn/feature\_selection/\_univariate\_selection.py:114: UserWarning:
Features [31 33 56 57 58 59 60 61] are constant.
  warnings.warn("Features \%s are constant." \% constant\_features\_idx,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(725325, 8)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{get-the-features-that-were-selected-probe}{%
\subsubsection{Get the features that were selected:
Probe}\label{get-the-features-that-were-selected-probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{true}\PY{o}{=}\PY{n}{selector}\PY{o}{.}\PY{n}{get\PYZus{}support}\PY{p}{(}\PY{p}{)}
\PY{n}{newcolindex\PYZus{}Probe}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{newcolname\PYZus{}Probe}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(} \PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{newcolindex\PYZus{}Probe} \PY{p}{)}
\PY{n}{newcolname\PYZus{}Probe}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[' Bwd Packet Length Min',
 ' Bwd Packet Length Mean',
 ' Min Packet Length',
 ' Packet Length Mean',
 ' PSH Flag Count',
 ' ACK Flag Count',
 ' Average Packet Size',
 'Init\_Win\_bytes\_forward']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}newWeb} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}Web}\PY{p}{,}\PY{n}{Y\PYZus{}Web}\PY{p}{)}
\PY{n}{X\PYZus{}newWeb}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/infres/mhyounet/.local/lib/python3.8/site-
packages/sklearn/feature\_selection/\_univariate\_selection.py:114: UserWarning:
Features [31 33 56 57 58 59 60 61] are constant.
  warnings.warn("Features \%s are constant." \% constant\_features\_idx,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(607781, 8)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{get-the-features-that-were-selected-web}{%
\subsubsection{Get the features that were selected:
Web}\label{get-the-features-that-were-selected-web}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{true}\PY{o}{=}\PY{n}{selector}\PY{o}{.}\PY{n}{get\PYZus{}support}\PY{p}{(}\PY{p}{)}
\PY{n}{newcolindex\PYZus{}Web}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{newcolname\PYZus{}Web}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(} \PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{newcolindex\PYZus{}Web}\PY{p}{)}
\PY{n}{newcolname\PYZus{}Web}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[' Destination Port',
 ' Bwd Packet Length Min',
 ' Min Packet Length',
 ' PSH Flag Count',
 ' Down/Up Ratio',
 ' Average Packet Size',
 'Init\_Win\_bytes\_forward',
 ' Init\_Win\_bytes\_backward']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}newInfil} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}Infil}\PY{p}{,}\PY{n}{Y\PYZus{}Infil}\PY{p}{)}
\PY{n}{X\PYZus{}newInfil}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/infres/mhyounet/.local/lib/python3.8/site-
packages/sklearn/feature\_selection/\_univariate\_selection.py:114: UserWarning:
Features [31 33 56 57 58 59 60 61] are constant.
  warnings.warn("Features \%s are constant." \% constant\_features\_idx,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(616534, 8)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{get-the-features-that-were-selected-infil}{%
\subsubsection{Get the features that were selected:
Infil}\label{get-the-features-that-were-selected-infil}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{true}\PY{o}{=}\PY{n}{selector}\PY{o}{.}\PY{n}{get\PYZus{}support}\PY{p}{(}\PY{p}{)}
\PY{n}{newcolindex\PYZus{}Infil}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{newcolname\PYZus{}Infil}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(} \PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{newcolindex\PYZus{}Infil}\PY{p}{)}
\PY{n}{newcolname\PYZus{}Infil}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
[' Bwd Packet Length Min',
 'Fwd PSH Flags',
 ' Min Packet Length',
 ' SYN Flag Count',
 ' PSH Flag Count',
 ' ACK Flag Count',
 ' Average Packet Size',
 'Init\_Win\_bytes\_forward']
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{summary-of-features-selected-by-univariate-feature-selection}{%
\section{Summary of features selected by Univariate Feature
Selection}\label{summary-of-features-selected-by-univariate-feature-selection}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for DoS:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{newcolname\PYZus{}DoS}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for Probe:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{newcolname\PYZus{}Probe}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for Web:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{newcolname\PYZus{}Web}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for Infil:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{newcolname\PYZus{}Infil}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Features selected for DoS: ['Bwd Packet Length Max', ' Bwd Packet Length Mean',
' Bwd Packet Length Std', ' Max Packet Length', ' Packet Length Mean', ' Packet
Length Std', ' Average Packet Size', ' Avg Bwd Segment Size']

Features selected for Probe: [' Bwd Packet Length Min', ' Bwd Packet Length
Mean', ' Min Packet Length', ' Packet Length Mean', ' PSH Flag Count', ' ACK
Flag Count', ' Average Packet Size', 'Init\_Win\_bytes\_forward']

Features selected for Web: [' Destination Port', ' Bwd Packet Length Min', ' Min
Packet Length', ' PSH Flag Count', ' Down/Up Ratio', ' Average Packet Size',
'Init\_Win\_bytes\_forward', ' Init\_Win\_bytes\_backward']

Features selected for Infil: [' Bwd Packet Length Min', 'Fwd PSH Flags', ' Min
Packet Length', ' SYN Flag Count', ' PSH Flag Count', ' ACK Flag Count', '
Average Packet Size', 'Init\_Win\_bytes\_forward']
    \end{Verbatim}

    \hypertarget{the-authors-state-that-after-obtaining-the-adequate-number-of-features-during-the-univariate-selection-process-a-recursive-feature-elimination-rfe-was-operated-with-the-number-of-features-passed-as-parameter-to-identify-the-features-selected.-this-either-implies-that-rfe-is-only-used-for-obtaining-the-features-previously-selected-but-also-obtaining-the-rank.-this-use-of-rfe-is-however-very-redundant-as-the-features-selected-can-be-obtained-in-another-way-done-in-this-project.-one-can-also-not-say-that-the-features-were-selected-by-rfe-as-it-was-not-used-for-this.-the-quote-could-however-also-imply-that-only-the-number-13-from-univariate-feature-selection-was-used.-rfe-is-then-used-for-feature-selection-trying-to-find-the-best-13-features.-with-this-use-of-rfe-one-can-actually-say-that-it-was-used-for-feature-selection.-however-the-authors-obtained-different-numbers-of-features-for-every-attack-category-12-for-dos-15-for-probe-13-for-web-and-11-for-infil.-this-concludes-that-it-is-not-clear-what-mechanism-is-used-for-feature-selection.}{%
\subsection{The authors state that ``After obtaining the adequate number
of features during the univariate selection process, a recursive feature
elimination (RFE) was operated with the number of features passed as
parameter to identify the features selected''. This either implies that
RFE is only used for obtaining the features previously selected but also
obtaining the rank. This use of RFE is however very redundant as the
features selected can be obtained in another way (Done in this project).
One can also not say that the features were selected by RFE, as it was
not used for this. The quote could however also imply that only the
number 13 from univariate feature selection was used. RFE is then used
for feature selection trying to find the best 13 features. With this use
of RFE one can actually say that it was used for feature selection.
However the authors obtained different numbers of features for every
attack category, 12 for DoS, 15 for Probe, 13 for Web and 11 for Infil.
This concludes that it is not clear what mechanism is used for feature
selection.}\label{the-authors-state-that-after-obtaining-the-adequate-number-of-features-during-the-univariate-selection-process-a-recursive-feature-elimination-rfe-was-operated-with-the-number-of-features-passed-as-parameter-to-identify-the-features-selected.-this-either-implies-that-rfe-is-only-used-for-obtaining-the-features-previously-selected-but-also-obtaining-the-rank.-this-use-of-rfe-is-however-very-redundant-as-the-features-selected-can-be-obtained-in-another-way-done-in-this-project.-one-can-also-not-say-that-the-features-were-selected-by-rfe-as-it-was-not-used-for-this.-the-quote-could-however-also-imply-that-only-the-number-13-from-univariate-feature-selection-was-used.-rfe-is-then-used-for-feature-selection-trying-to-find-the-best-13-features.-with-this-use-of-rfe-one-can-actually-say-that-it-was-used-for-feature-selection.-however-the-authors-obtained-different-numbers-of-features-for-every-attack-category-12-for-dos-15-for-probe-13-for-web-and-11-for-infil.-this-concludes-that-it-is-not-clear-what-mechanism-is-used-for-feature-selection.}}

\hypertarget{to-procede-with-the-data-mining-the-second-option-is-considered-as-this-uses-rfe.-from-now-on-the-number-of-features-for-every-attack-category-is-13.}{%
\subsection{To procede with the data mining, the second option is
considered as this uses RFE. From now on the number of features for
every attack category is
13.}\label{to-procede-with-the-data-mining-the-second-option-is-considered-as-this-uses-rfe.-from-now-on-the-number-of-features-for-every-attack-category-is-13.}}

    \hypertarget{recursive-feature-elimination-for-feature-ranking-option-1-get-importance-from-previous-selected}{%
\section{2. Recursive Feature Elimination for feature ranking (Option 1:
get importance from previous
selected)}\label{recursive-feature-elimination-for-feature-ranking-option-1-get-importance-from-previous-selected}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{53}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k+kn}{import} \PY{n}{RFE}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeClassifier}
\PY{c+c1}{\PYZsh{} Create a decision tree classifier. By convention, clf means \PYZsq{}classifier\PYZsq{}}
\PY{n}{clf} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{}rank all features, i.e continue the elimination until the last one}
\PY{n}{rfe} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}newDoS}\PY{p}{,} \PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS Features sorted by their rank:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{rfe}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{newcolname\PYZus{}DoS}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
DoS Features sorted by their rank:
[(1, ' Bwd Packet Length Std'), (2, ' Average Packet Size'), (3, ' Avg Bwd
Segment Size'), (4, ' Max Packet Length'), (5, ' Packet Length Std'), (6, ' Bwd
Packet Length Mean'), (7, ' Packet Length Mean'), (8, 'Bwd Packet Length Max')]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{54}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}newProbe}\PY{p}{,} \PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Probe Features sorted by their rank:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{rfe}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{newcolname\PYZus{}Probe}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Probe Features sorted by their rank:
[(1, ' Bwd Packet Length Mean'), (2, ' Packet Length Mean'), (3, ' PSH Flag
Count'), (4, ' Average Packet Size'), (5, ' Min Packet Length'), (6,
'Init\_Win\_bytes\_forward'), (7, ' ACK Flag Count'), (8, ' Bwd Packet Length
Min')]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{55}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}newWeb}\PY{p}{,} \PY{n}{Y\PYZus{}Web}\PY{p}{)}
 
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Web Features sorted by their rank:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{rfe}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{newcolname\PYZus{}Web}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Web Features sorted by their rank:
[(1, ' Init\_Win\_bytes\_backward'), (2, ' Average Packet Size'), (3, ' Destination
Port'), (4, 'Init\_Win\_bytes\_forward'), (5, ' Down/Up Ratio'), (6, ' Min Packet
Length'), (7, ' PSH Flag Count'), (8, ' Bwd Packet Length Min')]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{56}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}newInfil}\PY{p}{,} \PY{n}{Y\PYZus{}Infil}\PY{p}{)}
 
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Infil Features sorted by their rank:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{rfe}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{newcolname\PYZus{}Infil}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Infil Features sorted by their rank:
[(1, ' Average Packet Size'), (2, 'Init\_Win\_bytes\_forward'), (3, ' ACK Flag
Count'), (4, ' Min Packet Length'), (5, ' Bwd Packet Length Min'), (6, ' PSH
Flag Count'), (7, 'Fwd PSH Flags'), (8, ' SYN Flag Count')]
    \end{Verbatim}

    \hypertarget{recursive-feature-elimination-select-13-features-each-of-78-option-2-get-13-best-features-from-78-from-rfe}{%
\section{2. Recursive Feature Elimination, select 13 features each of 78
(Option 2: get 13 best features from 78 from
RFE)}\label{recursive-feature-elimination-select-13-features-each-of-78-option-2-get-13-best-features-from-78-from-rfe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{57}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k+kn}{import} \PY{n}{RFE}
\PY{n}{clf} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{rfe} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{clf}\PY{p}{,} \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{,} \PY{n}{step}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{,} \PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n}{X\PYZus{}rfeDoS}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{)}
\PY{n}{true}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{support\PYZus{}}
\PY{n}{rfecolindex\PYZus{}DoS}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{rfecolname\PYZus{}DoS}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{rfecolindex\PYZus{}DoS}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{58}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{,} \PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n}{X\PYZus{}rfeProbe}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{)}
\PY{n}{true}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{support\PYZus{}}
\PY{n}{rfecolindex\PYZus{}Probe}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{rfecolname\PYZus{}Probe}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{rfecolindex\PYZus{}Probe}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{59}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Web}\PY{p}{,} \PY{n}{Y\PYZus{}Web}\PY{p}{)}
\PY{n}{X\PYZus{}rfeWeb}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Web}\PY{p}{)}
\PY{n}{true}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{support\PYZus{}}
\PY{n}{rfecolindex\PYZus{}Web}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{rfecolname\PYZus{}Web}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{rfecolindex\PYZus{}Web}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{60}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Infil}\PY{p}{,} \PY{n}{Y\PYZus{}Infil}\PY{p}{)}
\PY{n}{X\PYZus{}rfeInfil}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Infil}\PY{p}{)}
\PY{n}{true}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{support\PYZus{}}
\PY{n}{rfecolindex\PYZus{}Infil}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{rfecolname\PYZus{}Infil}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{rfecolindex\PYZus{}Infil}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{summary-of-features-selected-by-rfe}{%
\section{Summary of features selected by
RFE}\label{summary-of-features-selected-by-rfe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{61}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for DoS:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{rfecolname\PYZus{}DoS}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for Probe:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{rfecolname\PYZus{}Probe}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for Web:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{rfecolname\PYZus{}Web}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for Infil:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{rfecolname\PYZus{}Infil}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Features selected for DoS: [' Destination Port', ' Total Length of Bwd Packets',
' Bwd Packet Length Std', ' Flow IAT Min', ' Fwd IAT Max', ' Fwd Header Length',
' Packet Length Mean', 'FIN Flag Count', ' Subflow Bwd Packets',
'Init\_Win\_bytes\_forward', ' Init\_Win\_bytes\_backward', ' Active Std', ' Idle
Max']

Features selected for Probe: [' Destination Port', ' Total Fwd Packets', 'Total
Length of Fwd Packets', 'Flow Bytes/s', ' Flow Packets/s', ' Flow IAT Mean', '
Flow IAT Max', ' Flow IAT Min', ' Bwd Packets/s', ' PSH Flag Count', ' Fwd
Header Length.1', 'Init\_Win\_bytes\_forward', ' Idle Min']

Features selected for Web: [' Destination Port', ' Flow Duration', 'Total Length
of Fwd Packets', ' Fwd Packet Length Max', ' Fwd IAT Min', ' Bwd IAT Max', ' Bwd
IAT Min', ' Bwd Packets/s', ' Avg Fwd Segment Size', ' Fwd Header Length.1',
'Init\_Win\_bytes\_forward', ' Init\_Win\_bytes\_backward', ' min\_seg\_size\_forward']

Features selected for Infil: [' Destination Port', 'Total Length of Fwd
Packets', ' Flow IAT Min', ' Fwd IAT Min', 'Fwd PSH Flags', ' Bwd Packets/s', '
Down/Up Ratio', ' Avg Bwd Segment Size', ' Subflow Fwd Bytes',
'Init\_Win\_bytes\_forward', ' Init\_Win\_bytes\_backward', ' min\_seg\_size\_forward', '
Active Min']
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{62}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}rfeDoS}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}rfeProbe}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}rfeWeb}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}rfeInfil}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
(892609, 13)
(725325, 13)
(607781, 13)
(616534, 13)
    \end{Verbatim}

    \hypertarget{step-4-build-the-model}{%
\section{Step 4: Build the model:}\label{step-4-build-the-model}}

\hypertarget{classifier-is-trained-for-all-features-and-for-reduced-features-for-later-comparison.}{%
\subsubsection{Classifier is trained for all features and for reduced
features, for later
comparison.}\label{classifier-is-trained-for-all-features-and-for-reduced-features-for-later-comparison.}}

\hypertarget{the-classifier-model-itself-is-stored-in-the-clf-variable.}{%
\paragraph{The classifier model itself is stored in the clf
variable.}\label{the-classifier-model-itself-is-stored-in-the-clf-variable.}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} all features}
\PY{n}{clf\PYZus{}DoS}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}Probe}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}Web}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}Infil}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}DoS}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{,} \PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n}{clf\PYZus{}Probe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{,} \PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n}{clf\PYZus{}Web}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Web}\PY{p}{,} \PY{n}{Y\PYZus{}Web}\PY{p}{)}
\PY{n}{clf\PYZus{}Infil}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Infil}\PY{p}{,} \PY{n}{Y\PYZus{}Infil}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeClassifier(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{64}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} selected features}
\PY{n}{clf\PYZus{}rfeDoS}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeProbe}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeWeb}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeInfil}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeDoS}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}rfeDoS}\PY{p}{,} \PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeProbe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}rfeProbe}\PY{p}{,} \PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeWeb}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}rfeWeb}\PY{p}{,} \PY{n}{Y\PYZus{}Web}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeInfil}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}rfeInfil}\PY{p}{,} \PY{n}{Y\PYZus{}Infil}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{64}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeClassifier(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{step-5-prediction-evaluation-validation}{%
\section{Step 5: Prediction \& Evaluation
(validation):}\label{step-5-prediction-evaluation-validation}}

    \hypertarget{using-all-features-for-each-category}{%
\section{Using all Features for each
category}\label{using-all-features-for-each-category}}

    \hypertarget{confusion-matrices}{%
\section{Confusion Matrices}\label{confusion-matrices}}

\hypertarget{dos}{%
\subsection{DoS}\label{dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Apply the classifier we trained to the test data (which it has never seen before)}
\PY{n}{clf\PYZus{}DoS}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([0, 0, 0, {\ldots}, 1, 0, 1])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} View the predicted probabilities of the first 10 observations}
\PY{n}{clf\PYZus{}DoS}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([[1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [0., 1.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.]])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{67}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{o}{=}\PY{n}{clf\PYZus{}DoS}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{67}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks       0      1
Actual attacks
0                  405079  30609
1                   65910  29325
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{probe}{%
\subsection{Probe}\label{probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{68}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{=}\PY{n}{clf\PYZus{}Probe}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{68}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks       0     2
Actual attacks
0                  433505  2183
2                   39620    10
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{web}{%
\subsection{Web}\label{web}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}Web\PYZus{}pred}\PY{o}{=}\PY{n}{clf\PYZus{}Web}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Web\PYZus{}test}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}Web\PYZus{}pred}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{69}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks       0  3
Actual attacks
0                  435681  7
3                     550  0
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{infil}{%
\subsection{Infil}\label{infil}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{70}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}Infil\PYZus{}pred}\PY{o}{=}\PY{n}{clf\PYZus{}Infil}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Infil\PYZus{}test}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}Infil\PYZus{}pred}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{70}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks       0    4
Actual attacks
0                  435577  111
4                    3490    6
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{accuracy-precision-recall-f-measure}{%
\section{Accuracy, Precision, Recall,
F-measure}\label{accuracy-precision-recall-f-measure}}

    TP = True Positive, TN = True Negative, FP = False Positive, FN = False
Negative

accuracy = (TP + TN) / (TP + TN + FP + FN)

precision = TP / (FP + TP)

recall = TP / (TP + FN)

f = (2 * precision * recall) / (precision + recall)

    \hypertarget{dos}{%
\subsection{DoS}\label{dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{71}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{metrics}
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.81821
Precision: 0.48929
Recall: 0.30792
F-measure: 0.37797
    \end{Verbatim}

    \hypertarget{probe}{%
\section{Probe}\label{probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{72}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.91205
Precision: 0.00456
Recall: 0.00025
F-measure: 0.00048
    \end{Verbatim}

    \hypertarget{web}{%
\subsection{Web}\label{web}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{73}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}Web\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}Web\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}Web\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}Web\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.99872
Precision: 0.00000
Recall: 0.00000
F-measure: 0.00000
    \end{Verbatim}

    \hypertarget{infil}{%
\subsection{Infil}\label{infil}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{74}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}Infil\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}Infil\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}Infil\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}Infil\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.99180
Precision: 0.05128
Recall: 0.00172
F-measure: 0.00332
    \end{Verbatim}

    \hypertarget{using-13-features-for-each-category}{%
\section{Using 13 Features for each
category}\label{using-13-features-for-each-category}}

    \hypertarget{confusion-matrices}{%
\section{Confusion Matrices}\label{confusion-matrices}}

\hypertarget{dos}{%
\subsection{DoS}\label{dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} reduce test dataset to 13 features, use only features described in rfecolname\PYZus{}DoS etc.}
\PY{n}{X\PYZus{}DoS\PYZus{}test2}\PY{o}{=}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{rfecolindex\PYZus{}DoS}\PY{p}{]}
\PY{n}{X\PYZus{}Probe\PYZus{}test2}\PY{o}{=}\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{rfecolindex\PYZus{}Probe}\PY{p}{]}
\PY{n}{X\PYZus{}Web\PYZus{}test2}\PY{o}{=}\PY{n}{X\PYZus{}Web\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{rfecolindex\PYZus{}Web}\PY{p}{]}
\PY{n}{X\PYZus{}Infil\PYZus{}test2}\PY{o}{=}\PY{n}{X\PYZus{}Infil\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{rfecolindex\PYZus{}Infil}\PY{p}{]}
\PY{n}{X\PYZus{}Infil\PYZus{}test2}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{75}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(439184, 13)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{76}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{o}{=}\PY{n}{clf\PYZus{}rfeDoS}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test2}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{76}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks       0      1
Actual attacks
0                  405894  29794
1                   66640  28595
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{probe}{%
\subsection{Probe}\label{probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{=}\PY{n}{clf\PYZus{}rfeProbe}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Probe\PYZus{}test2}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{77}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks       0       2
Actual attacks
0                  331255  104433
2                   39549      81
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{web}{%
\subsection{Web}\label{web}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{78}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}Web\PYZus{}pred2}\PY{o}{=}\PY{n}{clf\PYZus{}rfeWeb}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Web\PYZus{}test2}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}Web\PYZus{}pred2}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{78}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks       0  3
Actual attacks
0                  435681  7
3                     550  0
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{infil}{%
\subsection{Infil}\label{infil}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{79}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}Infil\PYZus{}pred2}\PY{o}{=}\PY{n}{clf\PYZus{}rfeInfil}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Infil\PYZus{}test2}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}Infil\PYZus{}pred2}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{79}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks       0    4
Actual attacks
0                  435567  121
4                    3451   45
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{accuracy-precision-recall-f-measure}{%
\section{Accuracy, Precision, Recall,
F-measure}\label{accuracy-precision-recall-f-measure}}

    TP = True Positive, TN = True Negative, FP = False Positive, FN = False
Negative

accuracy = (TP + TN) / (TP + TN + FP + FN)

precision = TP / (FP + TP)

recall = TP / (TP + FN)

f = (2 * precision * recall) / (precision + recall)

    \hypertarget{dos}{%
\subsection{DoS}\label{dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{80}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{metrics}
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.81837
Precision: 0.48973
Recall: 0.30026
F-measure: 0.37227
    \end{Verbatim}

    \hypertarget{probe}{%
\section{Probe}\label{probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{81}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.69708
Precision: 0.00078
Recall: 0.00204
F-measure: 0.00112
    \end{Verbatim}

    \hypertarget{web}{%
\subsection{Web}\label{web}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{82}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}Web\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}Web\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}Web\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Web\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}Web\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.99872
Precision: 0.00000
Recall: 0.00000
F-measure: 0.00000
    \end{Verbatim}

    \hypertarget{infil}{%
\subsection{Infil}\label{infil}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{83}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}Infil\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}Infil\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}Infil\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Infil\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}Infil\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.99187
Precision: 0.27108
Recall: 0.01287
F-measure: 0.02458
    \end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
