\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{DecisionTree\_IDS}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{modelling-intrusion-detection-analysis-of-a-feature-selection-mechanism}{%
\section{Modelling Intrusion Detection: Analysis of a Feature Selection
Mechanism}\label{modelling-intrusion-detection-analysis-of-a-feature-selection-mechanism}}

\hypertarget{method-description}{%
\subsection{Method Description}\label{method-description}}

\hypertarget{step-1-data-preprocessing}{%
\subsubsection{Step 1: Data
preprocessing:}\label{step-1-data-preprocessing}}

All features are made numerical using one-Hot-encoding. The features are
scaled to avoid features with large values that may weigh too much in
the results.

\hypertarget{step-2-feature-selection}{%
\subsubsection{Step 2: Feature
Selection:}\label{step-2-feature-selection}}

Eliminate redundant and irrelevant data by selecting a subset of
relevant features that fully represents the given problem. Univariate
feature selection with ANOVA F-test. This analyzes each feature
individually to detemine the strength of the relationship between the
feature and labels. Using SecondPercentile method
(sklearn.feature\_selection) to select features based on percentile of
the highest scores. When this subset is found: Recursive Feature
Elimination (RFE) is applied.

\hypertarget{step-4-build-the-model}{%
\subsubsection{Step 4: Build the model:}\label{step-4-build-the-model}}

Decision tree model is built.

\hypertarget{step-5-prediction-evaluation-validation}{%
\subsubsection{Step 5: Prediction \& Evaluation
(validation):}\label{step-5-prediction-evaluation-validation}}

Using the test data to make predictions of the model. Multiple scores
are considered such as:accuracy score, recall, f-measure, confusion
matrix. perform a 10-fold cross-validation.

    \hypertarget{version-check}{%
\subsection{Version Check}\label{version-check}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
\PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
\PY{k+kn}{import} \PY{n+nn}{sys}
\PY{k+kn}{import} \PY{n+nn}{sklearn}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sys}\PY{o}{.}\PY{n}{version}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{sklearn}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
1.2.5
1.20.2
3.8.5 (default, May 27 2021, 13:30:53)
[GCC 9.3.0]
0.24.2
    \end{Verbatim}

    \hypertarget{load-the-dataset}{%
\subsection{Load the Dataset}\label{load-the-dataset}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} attach the column names to the dataset}
\PY{n}{col\PYZus{}names} \PY{o}{=} \PY{p}{[}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{duration}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{protocol\PYZus{}type}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{service}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{flag}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{src\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}bytes}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{land}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{wrong\PYZus{}fragment}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{urgent}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hot}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}failed\PYZus{}logins}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{logged\PYZus{}in}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}compromised}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{root\PYZus{}shell}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{su\PYZus{}attempted}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}root}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}file\PYZus{}creations}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}shells}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}access\PYZus{}files}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{num\PYZus{}outbound\PYZus{}cmds}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}host\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{is\PYZus{}guest\PYZus{}login}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}count}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}diff\PYZus{}srv\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}same\PYZus{}src\PYZus{}port\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}diff\PYZus{}host\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}serror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
    \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{dst\PYZus{}host\PYZus{}srv\PYZus{}rerror\PYZus{}rate}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{label}\PY{l+s+s2}{\PYZdq{}}\PY{p}{]}

\PY{c+c1}{\PYZsh{} KDDTrain+\PYZus{}2.csv \PYZam{} KDDTest+\PYZus{}2.csv are the datafiles without the last column about the difficulty score}
\PY{c+c1}{\PYZsh{} these have already been removed.}
\PY{n}{df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{KDDTrain+\PYZus{}2.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{names} \PY{o}{=} \PY{n}{col\PYZus{}names}\PY{p}{)}
\PY{n}{df\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{KDDTest+\PYZus{}2.csv}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{header}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{names} \PY{o}{=} \PY{n}{col\PYZus{}names}\PY{p}{)}

\PY{c+c1}{\PYZsh{} shape, this gives the dimensions of the dataset}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of the Training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of the Test set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Dimensions of the Training set: (125973, 42)
Dimensions of the Test set: (22544, 42)
    \end{Verbatim}

    \hypertarget{sample-view-of-the-training-dataset}{%
\subsection{Sample view of the training
dataset}\label{sample-view-of-the-training-dataset}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} first five rows}
\PY{n}{df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   duration protocol\_type   service flag  src\_bytes  dst\_bytes  land  \textbackslash{}
0         0           tcp  ftp\_data   SF        491          0     0
1         0           udp     other   SF        146          0     0
2         0           tcp   private   S0          0          0     0
3         0           tcp      http   SF        232       8153     0
4         0           tcp      http   SF        199        420     0

   wrong\_fragment  urgent  hot  {\ldots}  dst\_host\_srv\_count  \textbackslash{}
0               0       0    0  {\ldots}                  25
1               0       0    0  {\ldots}                   1
2               0       0    0  {\ldots}                  26
3               0       0    0  {\ldots}                 255
4               0       0    0  {\ldots}                 255

   dst\_host\_same\_srv\_rate  dst\_host\_diff\_srv\_rate  \textbackslash{}
0                    0.17                    0.03
1                    0.00                    0.60
2                    0.10                    0.05
3                    1.00                    0.00
4                    1.00                    0.00

   dst\_host\_same\_src\_port\_rate  dst\_host\_srv\_diff\_host\_rate  \textbackslash{}
0                         0.17                         0.00
1                         0.88                         0.00
2                         0.00                         0.00
3                         0.03                         0.04
4                         0.00                         0.00

   dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
0                  0.00                      0.00                  0.05
1                  0.00                      0.00                  0.00
2                  1.00                      1.00                  0.00
3                  0.03                      0.01                  0.00
4                  0.00                      0.00                  0.00

   dst\_host\_srv\_rerror\_rate    label
0                      0.00   normal
1                      0.00   normal
2                      0.00  neptune
3                      0.01   normal
4                      0.00   normal

[5 rows x 42 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{statistical-summary}{%
\subsection{Statistical Summary}\label{statistical-summary}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
           duration     src\_bytes     dst\_bytes           land  \textbackslash{}
count  125973.00000  1.259730e+05  1.259730e+05  125973.000000
mean      287.14465  4.556674e+04  1.977911e+04       0.000198
std      2604.51531  5.870331e+06  4.021269e+06       0.014086
min         0.00000  0.000000e+00  0.000000e+00       0.000000
25\%         0.00000  0.000000e+00  0.000000e+00       0.000000
50\%         0.00000  4.400000e+01  0.000000e+00       0.000000
75\%         0.00000  2.760000e+02  5.160000e+02       0.000000
max     42908.00000  1.379964e+09  1.309937e+09       1.000000

       wrong\_fragment         urgent            hot  num\_failed\_logins  \textbackslash{}
count   125973.000000  125973.000000  125973.000000      125973.000000
mean         0.022687       0.000111       0.204409           0.001222
std          0.253530       0.014366       2.149968           0.045239
min          0.000000       0.000000       0.000000           0.000000
25\%          0.000000       0.000000       0.000000           0.000000
50\%          0.000000       0.000000       0.000000           0.000000
75\%          0.000000       0.000000       0.000000           0.000000
max          3.000000       3.000000      77.000000           5.000000

           logged\_in  num\_compromised  {\ldots}  dst\_host\_count  \textbackslash{}
count  125973.000000    125973.000000  {\ldots}   125973.000000
mean        0.395736         0.279250  {\ldots}      182.148945
std         0.489010        23.942042  {\ldots}       99.206213
min         0.000000         0.000000  {\ldots}        0.000000
25\%         0.000000         0.000000  {\ldots}       82.000000
50\%         0.000000         0.000000  {\ldots}      255.000000
75\%         1.000000         0.000000  {\ldots}      255.000000
max         1.000000      7479.000000  {\ldots}      255.000000

       dst\_host\_srv\_count  dst\_host\_same\_srv\_rate  dst\_host\_diff\_srv\_rate  \textbackslash{}
count       125973.000000           125973.000000           125973.000000
mean           115.653005                0.521242                0.082951
std            110.702741                0.448949                0.188922
min              0.000000                0.000000                0.000000
25\%             10.000000                0.050000                0.000000
50\%             63.000000                0.510000                0.020000
75\%            255.000000                1.000000                0.070000
max            255.000000                1.000000                1.000000

       dst\_host\_same\_src\_port\_rate  dst\_host\_srv\_diff\_host\_rate  \textbackslash{}
count                125973.000000                125973.000000
mean                      0.148379                     0.032542
std                       0.308997                     0.112564
min                       0.000000                     0.000000
25\%                       0.000000                     0.000000
50\%                       0.000000                     0.000000
75\%                       0.060000                     0.020000
max                       1.000000                     1.000000

       dst\_host\_serror\_rate  dst\_host\_srv\_serror\_rate  dst\_host\_rerror\_rate  \textbackslash{}
count         125973.000000             125973.000000         125973.000000
mean               0.284452                  0.278485              0.118832
std                0.444784                  0.445669              0.306557
min                0.000000                  0.000000              0.000000
25\%                0.000000                  0.000000              0.000000
50\%                0.000000                  0.000000              0.000000
75\%                1.000000                  1.000000              0.000000
max                1.000000                  1.000000              1.000000

       dst\_host\_srv\_rerror\_rate
count             125973.000000
mean                   0.120240
std                    0.319459
min                    0.000000
25\%                    0.000000
50\%                    0.000000
75\%                    0.000000
max                    1.000000

[8 rows x 38 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{label-distribution-of-training-and-test-set}{%
\subsection{Label Distribution of Training and Test
set}\label{label-distribution-of-training-and-test-set}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Label distribution Training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Label distribution Test set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Label distribution Training set:
normal             67343
neptune            41214
satan               3633
ipsweep             3599
portsweep           2931
smurf               2646
nmap                1493
back                 956
teardrop             892
warezclient          890
pod                  201
guess\_passwd          53
buffer\_overflow       30
warezmaster           20
land                  18
imap                  11
rootkit               10
loadmodule             9
ftp\_write              8
multihop               7
phf                    4
perl                   3
spy                    2
Name: label, dtype: int64

Label distribution Test set:
normal             9711
neptune            4657
guess\_passwd       1231
mscan               996
warezmaster         944
apache2             737
satan               735
processtable        685
smurf               665
back                359
snmpguess           331
saint               319
mailbomb            293
snmpgetattack       178
portsweep           157
ipsweep             141
httptunnel          133
nmap                 73
pod                  41
buffer\_overflow      20
multihop             18
named                17
ps                   15
sendmail             14
rootkit              13
xterm                13
teardrop             12
xlock                 9
land                  7
xsnoop                4
ftp\_write             3
worm                  2
sqlattack             2
phf                   2
udpstorm              2
perl                  2
loadmodule            2
imap                  1
Name: label, dtype: int64
    \end{Verbatim}

    \hypertarget{step-1-data-preprocessing}{%
\section{Step 1: Data preprocessing:}\label{step-1-data-preprocessing}}

One-Hot-Encoding (one-of-K) is used to to transform all categorical
features into binary features. Requirement for One-Hot-encoding: ``The
input to this transformer should be a matrix of integers, denoting the
values taken on by categorical (discrete) features. The output will be a
sparse matrix where each column corresponds to one possible value of one
feature. It is assumed that input features take on values in the range
{[}0, n\_values).''

Therefore the features first need to be transformed with LabelEncoder,
to transform every category to a number.

    \hypertarget{identify-categorical-features}{%
\subsection{Identify categorical
features}\label{identify-categorical-features}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} colums that are categorical and not binary yet: protocol\PYZus{}type (column 2), service (column 3), flag (column 4).}
\PY{c+c1}{\PYZsh{} explore categorical features}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Training set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{col\PYZus{}name} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
    \PY{k}{if} \PY{n}{df}\PY{p}{[}\PY{n}{col\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{dtypes} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{object}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:}
        \PY{n}{unique\PYZus{}cat} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{n}{col\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Feature }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+si}{\PYZob{}col\PYZus{}name\PYZcb{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ has }\PY{l+s+si}{\PYZob{}unique\PYZus{}cat\PYZcb{}}\PY{l+s+s2}{ categories}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{col\PYZus{}name}\PY{o}{=}\PY{n}{col\PYZus{}name}\PY{p}{,} \PY{n}{unique\PYZus{}cat}\PY{o}{=}\PY{n}{unique\PYZus{}cat}\PY{p}{)}\PY{p}{)}

\PY{c+c1}{\PYZsh{}see how distributed the feature service is, it is evenly distributed and therefore we need to make dummies for all.}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Distribution of categories in service:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{service}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Training set:
Feature 'protocol\_type' has 3 categories
Feature 'service' has 70 categories
Feature 'flag' has 11 categories
Feature 'label' has 23 categories

Distribution of categories in service:
http        40338
private     21853
domain\_u     9043
smtp         7313
ftp\_data     6860
Name: service, dtype: int64
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Test set}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test set:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{k}{for} \PY{n}{col\PYZus{}name} \PY{o+ow}{in} \PY{n}{df\PYZus{}test}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
    \PY{k}{if} \PY{n}{df\PYZus{}test}\PY{p}{[}\PY{n}{col\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{dtypes} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{object}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:}
        \PY{n}{unique\PYZus{}cat} \PY{o}{=} \PY{n+nb}{len}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{p}{[}\PY{n}{col\PYZus{}name}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Feature }\PY{l+s+s2}{\PYZsq{}}\PY{l+s+si}{\PYZob{}col\PYZus{}name\PYZcb{}}\PY{l+s+s2}{\PYZsq{}}\PY{l+s+s2}{ has }\PY{l+s+si}{\PYZob{}unique\PYZus{}cat\PYZcb{}}\PY{l+s+s2}{ categories}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{col\PYZus{}name}\PY{o}{=}\PY{n}{col\PYZus{}name}\PY{p}{,} \PY{n}{unique\PYZus{}cat}\PY{o}{=}\PY{n}{unique\PYZus{}cat}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Test set:
Feature 'protocol\_type' has 3 categories
Feature 'service' has 64 categories
Feature 'flag' has 11 categories
Feature 'label' has 38 categories
    \end{Verbatim}

    \hypertarget{conclusion-need-to-make-dummies-for-all-categories-as-the-distribution-is-fairly-even.-in-total-3701184-dummies.}{%
\subsubsection{Conclusion: Need to make dummies for all categories as
the distribution is fairly even. In total: 3+70+11=84
dummies.}\label{conclusion-need-to-make-dummies-for-all-categories-as-the-distribution-is-fairly-even.-in-total-3701184-dummies.}}

\hypertarget{comparing-the-results-shows-that-the-test-set-has-fewer-categories-6-these-need-to-be-added-as-empty-columns.}{%
\subsubsection{Comparing the results shows that the Test set has fewer
categories (6), these need to be added as empty
columns.}\label{comparing-the-results-shows-that-the-test-set-has-fewer-categories-6-these-need-to-be-added-as-empty-columns.}}

    \hypertarget{labelencoder}{%
\section{LabelEncoder}\label{labelencoder}}

    \hypertarget{insert-categorical-features-into-a-2d-numpy-array}{%
\subsubsection{Insert categorical features into a 2D numpy
array}\label{insert-categorical-features-into-a-2d-numpy-array}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k+kn}{import} \PY{n}{LabelEncoder}\PY{p}{,}\PY{n}{OneHotEncoder}
\PY{n}{categorical\PYZus{}columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{protocol\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{service}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{c+c1}{\PYZsh{} insert code to get a list of categorical columns into a variable, categorical\PYZus{}columns}
\PY{n}{categorical\PYZus{}columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{protocol\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{service}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} 
 \PY{c+c1}{\PYZsh{} Get the categorical values into a 2D numpy array}
\PY{n}{df\PYZus{}categorical\PYZus{}values} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{categorical\PYZus{}columns}\PY{p}{]}
\PY{n}{testdf\PYZus{}categorical\PYZus{}values} \PY{o}{=} \PY{n}{df\PYZus{}test}\PY{p}{[}\PY{n}{categorical\PYZus{}columns}\PY{p}{]}
\PY{n}{df\PYZus{}categorical\PYZus{}values}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
  protocol\_type   service flag
0           tcp  ftp\_data   SF
1           udp     other   SF
2           tcp   private   S0
3           tcp      http   SF
4           tcp      http   SF
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{make-column-names-for-dummies}{%
\subsubsection{Make column names for
dummies}\label{make-column-names-for-dummies}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} protocol type}
\PY{n}{unique\PYZus{}protocol}\PY{o}{=}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{protocol\PYZus{}type}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n}{string1} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Protocol\PYZus{}type\PYZus{}}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{unique\PYZus{}protocol2}\PY{o}{=}\PY{p}{[}\PY{n}{string1} \PY{o}{+} \PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{unique\PYZus{}protocol}\PY{p}{]}
\PY{c+c1}{\PYZsh{} service}
\PY{n}{unique\PYZus{}service}\PY{o}{=}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{service}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n}{string2} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{service\PYZus{}}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{unique\PYZus{}service2}\PY{o}{=}\PY{p}{[}\PY{n}{string2} \PY{o}{+} \PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{unique\PYZus{}service}\PY{p}{]}
\PY{c+c1}{\PYZsh{} flag}
\PY{n}{unique\PYZus{}flag}\PY{o}{=}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{flag}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n}{string3} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flag\PYZus{}}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{unique\PYZus{}flag2}\PY{o}{=}\PY{p}{[}\PY{n}{string3} \PY{o}{+} \PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{unique\PYZus{}flag}\PY{p}{]}
\PY{c+c1}{\PYZsh{} put together}
\PY{n}{dumcols}\PY{o}{=}\PY{n}{unique\PYZus{}protocol2} \PY{o}{+} \PY{n}{unique\PYZus{}service2} \PY{o}{+} \PY{n}{unique\PYZus{}flag2}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{dumcols}\PY{p}{)}

\PY{c+c1}{\PYZsh{}do same for test set}
\PY{n}{unique\PYZus{}service\PYZus{}test}\PY{o}{=}\PY{n+nb}{sorted}\PY{p}{(}\PY{n}{df\PYZus{}test}\PY{o}{.}\PY{n}{service}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{n}{unique\PYZus{}service2\PYZus{}test}\PY{o}{=}\PY{p}{[}\PY{n}{string2} \PY{o}{+} \PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{unique\PYZus{}service\PYZus{}test}\PY{p}{]}
\PY{n}{testdumcols}\PY{o}{=}\PY{n}{unique\PYZus{}protocol2} \PY{o}{+} \PY{n}{unique\PYZus{}service2\PYZus{}test} \PY{o}{+} \PY{n}{unique\PYZus{}flag2}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
['Protocol\_type\_icmp', 'Protocol\_type\_tcp', 'Protocol\_type\_udp', 'service\_IRC',
'service\_X11', 'service\_Z39\_50', 'service\_aol', 'service\_auth', 'service\_bgp',
'service\_courier', 'service\_csnet\_ns', 'service\_ctf', 'service\_daytime',
'service\_discard', 'service\_domain', 'service\_domain\_u', 'service\_echo',
'service\_eco\_i', 'service\_ecr\_i', 'service\_efs', 'service\_exec',
'service\_finger', 'service\_ftp', 'service\_ftp\_data', 'service\_gopher',
'service\_harvest', 'service\_hostnames', 'service\_http', 'service\_http\_2784',
'service\_http\_443', 'service\_http\_8001', 'service\_imap4', 'service\_iso\_tsap',
'service\_klogin', 'service\_kshell', 'service\_ldap', 'service\_link',
'service\_login', 'service\_mtp', 'service\_name', 'service\_netbios\_dgm',
'service\_netbios\_ns', 'service\_netbios\_ssn', 'service\_netstat', 'service\_nnsp',
'service\_nntp', 'service\_ntp\_u', 'service\_other', 'service\_pm\_dump',
'service\_pop\_2', 'service\_pop\_3', 'service\_printer', 'service\_private',
'service\_red\_i', 'service\_remote\_job', 'service\_rje', 'service\_shell',
'service\_smtp', 'service\_sql\_net', 'service\_ssh', 'service\_sunrpc',
'service\_supdup', 'service\_systat', 'service\_telnet', 'service\_tftp\_u',
'service\_tim\_i', 'service\_time', 'service\_urh\_i', 'service\_urp\_i',
'service\_uucp', 'service\_uucp\_path', 'service\_vmnet', 'service\_whois',
'flag\_OTH', 'flag\_REJ', 'flag\_RSTO', 'flag\_RSTOS0', 'flag\_RSTR', 'flag\_S0',
'flag\_S1', 'flag\_S2', 'flag\_S3', 'flag\_SF', 'flag\_SH']
    \end{Verbatim}

    \hypertarget{transform-categorical-features-into-numbers-using-labelencoder}{%
\subsection{Transform categorical features into numbers using
LabelEncoder()}\label{transform-categorical-features-into-numbers-using-labelencoder}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{df\PYZus{}categorical\PYZus{}values\PYZus{}enc}\PY{o}{=}\PY{n}{df\PYZus{}categorical\PYZus{}values}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{df\PYZus{}categorical\PYZus{}values\PYZus{}enc}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\PY{c+c1}{\PYZsh{} test set}
\PY{n}{testdf\PYZus{}categorical\PYZus{}values\PYZus{}enc}\PY{o}{=}\PY{n}{testdf\PYZus{}categorical\PYZus{}values}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{n}{LabelEncoder}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
   protocol\_type  service  flag
0              1       20     9
1              2       44     9
2              1       49     5
3              1       24     9
4              1       24     9
    \end{Verbatim}

    \hypertarget{one-hot-encoding}{%
\section{One-Hot-Encoding}\label{one-hot-encoding}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{enc} \PY{o}{=} \PY{n}{OneHotEncoder}\PY{p}{(}\PY{p}{)}
\PY{n}{df\PYZus{}categorical\PYZus{}values\PYZus{}encenc} \PY{o}{=} \PY{n}{enc}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{df\PYZus{}categorical\PYZus{}values\PYZus{}enc}\PY{p}{)}
\PY{n}{df\PYZus{}cat\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{df\PYZus{}categorical\PYZus{}values\PYZus{}encenc}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{dumcols}\PY{p}{)}
\PY{c+c1}{\PYZsh{} test set}
\PY{n}{testdf\PYZus{}categorical\PYZus{}values\PYZus{}encenc} \PY{o}{=} \PY{n}{enc}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{testdf\PYZus{}categorical\PYZus{}values\PYZus{}enc}\PY{p}{)}
\PY{n}{testdf\PYZus{}cat\PYZus{}data} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{testdf\PYZus{}categorical\PYZus{}values\PYZus{}encenc}\PY{o}{.}\PY{n}{toarray}\PY{p}{(}\PY{p}{)}\PY{p}{,}\PY{n}{columns}\PY{o}{=}\PY{n}{testdumcols}\PY{p}{)}

\PY{n}{df\PYZus{}cat\PYZus{}data}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
   Protocol\_type\_icmp  Protocol\_type\_tcp  Protocol\_type\_udp  service\_IRC  \textbackslash{}
0                 0.0                1.0                0.0          0.0
1                 0.0                0.0                1.0          0.0
2                 0.0                1.0                0.0          0.0
3                 0.0                1.0                0.0          0.0
4                 0.0                1.0                0.0          0.0

   service\_X11  service\_Z39\_50  service\_aol  service\_auth  service\_bgp  \textbackslash{}
0          0.0             0.0          0.0           0.0          0.0
1          0.0             0.0          0.0           0.0          0.0
2          0.0             0.0          0.0           0.0          0.0
3          0.0             0.0          0.0           0.0          0.0
4          0.0             0.0          0.0           0.0          0.0

   service\_courier  {\ldots}  flag\_REJ  flag\_RSTO  flag\_RSTOS0  flag\_RSTR  flag\_S0  \textbackslash{}
0              0.0  {\ldots}       0.0        0.0          0.0        0.0      0.0
1              0.0  {\ldots}       0.0        0.0          0.0        0.0      0.0
2              0.0  {\ldots}       0.0        0.0          0.0        0.0      1.0
3              0.0  {\ldots}       0.0        0.0          0.0        0.0      0.0
4              0.0  {\ldots}       0.0        0.0          0.0        0.0      0.0

   flag\_S1  flag\_S2  flag\_S3  flag\_SF  flag\_SH
0      0.0      0.0      0.0      1.0      0.0
1      0.0      0.0      0.0      1.0      0.0
2      0.0      0.0      0.0      0.0      0.0
3      0.0      0.0      0.0      1.0      0.0
4      0.0      0.0      0.0      1.0      0.0

[5 rows x 84 columns]
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{add-6-missing-categories-from-train-set-to-test-set}{%
\subsubsection{Add 6 missing categories from train set to test
set}\label{add-6-missing-categories-from-train-set-to-test-set}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{trainservice}\PY{o}{=}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{service}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
\PY{n}{testservice}\PY{o}{=} \PY{n}{df\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{service}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{tolist}\PY{p}{(}\PY{p}{)}
\PY{n}{difference}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{trainservice}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n+nb}{set}\PY{p}{(}\PY{n}{testservice}\PY{p}{)}\PY{p}{)}
\PY{n}{string} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{service\PYZus{}}\PY{l+s+s1}{\PYZsq{}}
\PY{n}{difference}\PY{o}{=}\PY{p}{[}\PY{n}{string} \PY{o}{+} \PY{n}{x} \PY{k}{for} \PY{n}{x} \PY{o+ow}{in} \PY{n}{difference}\PY{p}{]}
\PY{n}{difference}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['service\_http\_2784',
 'service\_aol',
 'service\_red\_i',
 'service\_urh\_i',
 'service\_http\_8001',
 'service\_harvest']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{difference}\PY{p}{:}
    \PY{n}{testdf\PYZus{}cat\PYZus{}data}\PY{p}{[}\PY{n}{col}\PY{p}{]} \PY{o}{=} \PY{l+m+mi}{0}

\PY{n}{testdf\PYZus{}cat\PYZus{}data}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(22544, 84)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{join-encoded-categorical-dataframe-with-the-non-categorical-dataframe}{%
\subsection{Join encoded categorical dataframe with the non-categorical
dataframe}\label{join-encoded-categorical-dataframe-with-the-non-categorical-dataframe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{newdf}\PY{o}{=}\PY{n}{df}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{df\PYZus{}cat\PYZus{}data}\PY{p}{)}
\PY{n}{newdf}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{newdf}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{protocol\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{newdf}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{service}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{c+c1}{\PYZsh{} test data}
\PY{n}{newdf\PYZus{}test}\PY{o}{=}\PY{n}{df\PYZus{}test}\PY{o}{.}\PY{n}{join}\PY{p}{(}\PY{n}{testdf\PYZus{}cat\PYZus{}data}\PY{p}{)}
\PY{n}{newdf\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{flag}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{newdf\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{protocol\PYZus{}type}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n}{newdf\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{service}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{newdf}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{newdf\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
(125973, 123)
(22544, 123)
    \end{Verbatim}

    \hypertarget{split-dataset-into-4-datasets-for-every-attack-category}{%
\section{Split Dataset into 4 datasets for every attack
category}\label{split-dataset-into-4-datasets-for-every-attack-category}}

\hypertarget{rename-every-attack-label-0normal-1dos-2probe-3r2l-and-4u2r.}{%
\subsection{Rename every attack label: 0=normal, 1=DoS, 2=Probe, 3=R2L
and
4=U2R.}\label{rename-every-attack-label-0normal-1dos-2probe-3r2l-and-4u2r.}}

\hypertarget{replace-labels-column-with-new-labels-column}{%
\subsection{Replace labels column with new labels
column}\label{replace-labels-column-with-new-labels-column}}

\hypertarget{make-new-datasets}{%
\subsection{Make new datasets}\label{make-new-datasets}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} take label column}
\PY{n}{labeldf}\PY{o}{=}\PY{n}{newdf}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{n}{labeldf\PYZus{}test}\PY{o}{=}\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\PY{c+c1}{\PYZsh{} change the label column}
\PY{n}{newlabeldf}\PY{o}{=}\PY{n}{labeldf}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{\PYZob{}} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{normal}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neptune}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{1} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{back}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{land}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pod}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{smurf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{teardrop}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mailbomb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{apache2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{processtable}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{udpstorm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{worm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ipsweep}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{nmap}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{portsweep}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{satan}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mscan}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{saint}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}
                           \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ftp\PYZus{}write}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{guess\PYZus{}passwd}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{multihop}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{warezclient}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{warezmaster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sendmail}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{named}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{snmpgetattack}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{snmpguess}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xlock}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xsnoop}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{httptunnel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{buffer\PYZus{}overflow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loadmodule}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{perl}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rootkit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ps}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqlattack}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xterm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{n}{newlabeldf\PYZus{}test}\PY{o}{=}\PY{n}{labeldf\PYZus{}test}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{\PYZob{}} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{normal}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{neptune}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{1} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{back}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{land}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pod}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{smurf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{teardrop}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mailbomb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{apache2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{processtable}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{udpstorm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{worm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ipsweep}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{nmap}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{portsweep}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{satan}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mscan}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{saint}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{l+m+mi}{2}
                           \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ftp\PYZus{}write}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{guess\PYZus{}passwd}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{imap}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{multihop}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{phf}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{spy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{warezclient}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{warezmaster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sendmail}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{named}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{snmpgetattack}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{snmpguess}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xlock}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xsnoop}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{httptunnel}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}
                           \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{buffer\PYZus{}overflow}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loadmodule}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{perl}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rootkit}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ps}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{sqlattack}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{xterm}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{\PYZcb{}}\PY{p}{)}
\PY{c+c1}{\PYZsh{} put the new label column back}
\PY{n}{newdf}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{newlabeldf}
\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{newlabeldf\PYZus{}test}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{newdf}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
0    0
1    0
2    1
3    0
4    0
Name: label, dtype: int64
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{to\PYZus{}drop\PYZus{}DoS} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{]}
\PY{n}{to\PYZus{}drop\PYZus{}Probe} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{]}
\PY{n}{to\PYZus{}drop\PYZus{}R2L} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{]}
\PY{n}{to\PYZus{}drop\PYZus{}U2R} \PY{o}{=} \PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}
\PY{n}{DoS\PYZus{}df}\PY{o}{=}\PY{n}{newdf}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{newdf}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}DoS}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{Probe\PYZus{}df}\PY{o}{=}\PY{n}{newdf}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{newdf}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}Probe}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{R2L\PYZus{}df}\PY{o}{=}\PY{n}{newdf}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{newdf}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}R2L}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{U2R\PYZus{}df}\PY{o}{=}\PY{n}{newdf}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{newdf}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}U2R}\PY{p}{)}\PY{p}{]}\PY{p}{;}

\PY{c+c1}{\PYZsh{}test}
\PY{n}{DoS\PYZus{}df\PYZus{}test}\PY{o}{=}\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}DoS}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{Probe\PYZus{}df\PYZus{}test}\PY{o}{=}\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}Probe}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{R2L\PYZus{}df\PYZus{}test}\PY{o}{=}\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}R2L}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n}{U2R\PYZus{}df\PYZus{}test}\PY{o}{=}\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{o}{\PYZti{}}\PY{n}{newdf\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{to\PYZus{}drop\PYZus{}U2R}\PY{p}{)}\PY{p}{]}\PY{p}{;}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Train:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of DoS:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{DoS\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of Probe:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{Probe\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of R2L:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{R2L\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of U2R:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{U2R\PYZus{}df}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Test:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of DoS:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{DoS\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of Probe:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{Probe\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of R2L:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{R2L\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Dimensions of U2R:}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{n}{U2R\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Train:
Dimensions of DoS: (113270, 123)
Dimensions of Probe: (78999, 123)
Dimensions of R2L: (68338, 123)
Dimensions of U2R: (67395, 123)
Test:
Dimensions of DoS: (17171, 123)
Dimensions of Probe: (12132, 123)
Dimensions of R2L: (12596, 123)
Dimensions of U2R: (9778, 123)
    \end{Verbatim}

    \hypertarget{step-2-feature-scaling}{%
\section{Step 2: Feature Scaling:}\label{step-2-feature-scaling}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Split dataframes into X \PYZam{} Y}
\PY{c+c1}{\PYZsh{} assign X as a dataframe of feautures and Y as a series of outcome variables}
\PY{n}{X\PYZus{}DoS} \PY{o}{=} \PY{n}{DoS\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}DoS} \PY{o}{=} \PY{n}{DoS\PYZus{}df}\PY{o}{.}\PY{n}{label}
\PY{n}{X\PYZus{}Probe} \PY{o}{=} \PY{n}{Probe\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}Probe} \PY{o}{=} \PY{n}{Probe\PYZus{}df}\PY{o}{.}\PY{n}{label}
\PY{n}{X\PYZus{}R2L} \PY{o}{=} \PY{n}{R2L\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}R2L} \PY{o}{=} \PY{n}{R2L\PYZus{}df}\PY{o}{.}\PY{n}{label}
\PY{n}{X\PYZus{}U2R} \PY{o}{=} \PY{n}{U2R\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}U2R} \PY{o}{=} \PY{n}{U2R\PYZus{}df}\PY{o}{.}\PY{n}{label}
\PY{c+c1}{\PYZsh{} test set}
\PY{n}{X\PYZus{}DoS\PYZus{}test} \PY{o}{=} \PY{n}{DoS\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}DoS\PYZus{}test} \PY{o}{=} \PY{n}{DoS\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{label}
\PY{n}{X\PYZus{}Probe\PYZus{}test} \PY{o}{=} \PY{n}{Probe\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}Probe\PYZus{}test} \PY{o}{=} \PY{n}{Probe\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{label}
\PY{n}{X\PYZus{}R2L\PYZus{}test} \PY{o}{=} \PY{n}{R2L\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}R2L\PYZus{}test} \PY{o}{=} \PY{n}{R2L\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{label}
\PY{n}{X\PYZus{}U2R\PYZus{}test} \PY{o}{=} \PY{n}{U2R\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{label}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{Y\PYZus{}U2R\PYZus{}test} \PY{o}{=} \PY{n}{U2R\PYZus{}df\PYZus{}test}\PY{o}{.}\PY{n}{label}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{save-a-list-of-feature-names-for-later-use-it-is-the-same-for-every-attack-category.-column-names-are-dropped-at-this-stage.}{%
\subsubsection{Save a list of feature names for later use (it is the
same for every attack category). Column names are dropped at this
stage.}\label{save-a-list-of-feature-names-for-later-use-it-is-the-same-for-every-attack-category.-column-names-are-dropped-at-this-stage.}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{colNames}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{)}
\PY{n}{colNames\PYZus{}test}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{use-standardscaler-to-scale-the-dataframes}{%
\subsection{Use StandardScaler() to scale the
dataframes}\label{use-standardscaler-to-scale-the-dataframes}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{preprocessing}
\PY{n}{scaler1} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{)}
\PY{n}{X\PYZus{}DoS}\PY{o}{=}\PY{n}{scaler1}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{)} 
\PY{n}{scaler2} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{)}
\PY{n}{X\PYZus{}Probe}\PY{o}{=}\PY{n}{scaler2}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{)} 
\PY{n}{scaler3} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}R2L}\PY{p}{)}
\PY{n}{X\PYZus{}R2L}\PY{o}{=}\PY{n}{scaler3}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}R2L}\PY{p}{)} 
\PY{n}{scaler4} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}U2R}\PY{p}{)}
\PY{n}{X\PYZus{}U2R}\PY{o}{=}\PY{n}{scaler4}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}U2R}\PY{p}{)} 
\PY{c+c1}{\PYZsh{} test data}
\PY{n}{scaler5} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}
\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{o}{=}\PY{n}{scaler5}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)} 
\PY{n}{scaler6} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{p}{)}
\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{o}{=}\PY{n}{scaler6}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{p}{)} 
\PY{n}{scaler7} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}R2L\PYZus{}test}\PY{p}{)}
\PY{n}{X\PYZus{}R2L\PYZus{}test}\PY{o}{=}\PY{n}{scaler7}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}R2L\PYZus{}test}\PY{p}{)} 
\PY{n}{scaler8} \PY{o}{=} \PY{n}{preprocessing}\PY{o}{.}\PY{n}{StandardScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}U2R\PYZus{}test}\PY{p}{)}
\PY{n}{X\PYZus{}U2R\PYZus{}test}\PY{o}{=}\PY{n}{scaler8}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}U2R\PYZus{}test}\PY{p}{)} 
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{check-that-the-standard-deviation-is-1}{%
\subsubsection{Check that the Standard Deviation is
1}\label{check-that-the-standard-deviation-is-1}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
[1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 0. 1. 0. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 1. 1. 1. 1. 1.
 1. 1.]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}Probe}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{;}
\PY{n}{X\PYZus{}R2L}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{;}
\PY{n}{X\PYZus{}U2R}\PY{o}{.}\PY{n}{std}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{;}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{step-3-feature-selection}{%
\section{Step 3: Feature Selection:}\label{step-3-feature-selection}}

    \hypertarget{univariate-feature-selection-using-anova-f-test}{%
\section{1. Univariate Feature Selection using ANOVA
F-test}\label{univariate-feature-selection-using-anova-f-test}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{}univariate feature selection with ANOVA F\PYZhy{}test. using secondPercentile method, then RFE}
\PY{c+c1}{\PYZsh{}Scikit\PYZhy{}learn exposes feature selection routines as objects that implement the transform method}
\PY{c+c1}{\PYZsh{}SelectPercentile: removes all but a user\PYZhy{}specified highest scoring percentage of features}
\PY{c+c1}{\PYZsh{}f\PYZus{}classif: ANOVA F\PYZhy{}value between label/feature for classification tasks.}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k+kn}{import} \PY{n}{SelectPercentile}\PY{p}{,} \PY{n}{f\PYZus{}classif}
\PY{n}{np}\PY{o}{.}\PY{n}{seterr}\PY{p}{(}\PY{n}{divide}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{invalid}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ignore}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\PY{n}{selector}\PY{o}{=}\PY{n}{SelectPercentile}\PY{p}{(}\PY{n}{f\PYZus{}classif}\PY{p}{,} \PY{n}{percentile}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{)}
\PY{n}{X\PYZus{}newDoS} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{,}\PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n}{X\PYZus{}newDoS}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/lyt/.local/lib/python3.8/site-
packages/sklearn/feature\_selection/\_univariate\_selection.py:114: UserWarning:
Features [ 16  44  63  66  68  86 114] are constant.
  warnings.warn("Features \%s are constant." \% constant\_features\_idx,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(113270, 13)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{get-the-features-that-were-selected-dos}{%
\subsubsection{Get the features that were selected:
DoS}\label{get-the-features-that-were-selected-dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{true}\PY{o}{=}\PY{n}{selector}\PY{o}{.}\PY{n}{get\PYZus{}support}\PY{p}{(}\PY{p}{)}
\PY{n}{newcolindex\PYZus{}DoS}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{newcolname\PYZus{}DoS}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(} \PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{newcolindex\PYZus{}DoS} \PY{p}{)}
\PY{n}{newcolname\PYZus{}DoS}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['logged\_in',
 'count',
 'serror\_rate',
 'srv\_serror\_rate',
 'same\_srv\_rate',
 'dst\_host\_count',
 'dst\_host\_srv\_count',
 'dst\_host\_same\_srv\_rate',
 'dst\_host\_serror\_rate',
 'dst\_host\_srv\_serror\_rate',
 'service\_http',
 'flag\_S0',
 'flag\_SF']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}newProbe} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{,}\PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n}{X\PYZus{}newProbe}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/lyt/.local/lib/python3.8/site-
packages/sklearn/feature\_selection/\_univariate\_selection.py:114: UserWarning:
Features [ 4 16] are constant.
  warnings.warn("Features \%s are constant." \% constant\_features\_idx,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(78999, 13)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{get-the-features-that-were-selected-probe}{%
\subsubsection{Get the features that were selected:
Probe}\label{get-the-features-that-were-selected-probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{true}\PY{o}{=}\PY{n}{selector}\PY{o}{.}\PY{n}{get\PYZus{}support}\PY{p}{(}\PY{p}{)}
\PY{n}{newcolindex\PYZus{}Probe}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{newcolname\PYZus{}Probe}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(} \PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{newcolindex\PYZus{}Probe} \PY{p}{)}
\PY{n}{newcolname\PYZus{}Probe}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['logged\_in',
 'rerror\_rate',
 'srv\_rerror\_rate',
 'dst\_host\_srv\_count',
 'dst\_host\_diff\_srv\_rate',
 'dst\_host\_same\_src\_port\_rate',
 'dst\_host\_srv\_diff\_host\_rate',
 'dst\_host\_rerror\_rate',
 'dst\_host\_srv\_rerror\_rate',
 'Protocol\_type\_icmp',
 'service\_eco\_i',
 'service\_private',
 'flag\_SF']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}newR2L} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}R2L}\PY{p}{,}\PY{n}{Y\PYZus{}R2L}\PY{p}{)}
\PY{n}{X\PYZus{}newR2L}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/lyt/.local/lib/python3.8/site-
packages/sklearn/feature\_selection/\_univariate\_selection.py:114: UserWarning:
Features [  4  16  43  44  46  47  48  49  50  51  54  57  58  62  63  64  66
67
  68  70  71  72  73  74  76  77  78  79  80  81  82  83  86  87  89  92
  93  96  98  99 100 107 108 109 110 114] are constant.
  warnings.warn("Features \%s are constant." \% constant\_features\_idx,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(68338, 13)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{get-the-features-that-were-selected-r2l}{%
\subsubsection{Get the features that were selected:
R2L}\label{get-the-features-that-were-selected-r2l}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{true}\PY{o}{=}\PY{n}{selector}\PY{o}{.}\PY{n}{get\PYZus{}support}\PY{p}{(}\PY{p}{)}
\PY{n}{newcolindex\PYZus{}R2L}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{newcolname\PYZus{}R2L}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(} \PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{newcolindex\PYZus{}R2L}\PY{p}{)}
\PY{n}{newcolname\PYZus{}R2L}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['src\_bytes',
 'dst\_bytes',
 'hot',
 'num\_failed\_logins',
 'is\_guest\_login',
 'dst\_host\_srv\_count',
 'dst\_host\_same\_src\_port\_rate',
 'dst\_host\_srv\_diff\_host\_rate',
 'service\_ftp',
 'service\_ftp\_data',
 'service\_http',
 'service\_imap4',
 'flag\_RSTO']
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{X\PYZus{}newU2R} \PY{o}{=} \PY{n}{selector}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{X\PYZus{}U2R}\PY{p}{,}\PY{n}{Y\PYZus{}U2R}\PY{p}{)}
\PY{n}{X\PYZus{}newU2R}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/lyt/.local/lib/python3.8/site-
packages/sklearn/feature\_selection/\_univariate\_selection.py:114: UserWarning:
Features [  4  16  43  44  46  47  48  49  50  51  54  57  58  62  63  64  66
67
  68  70  71  72  73  74  75  76  77  78  79  80  81  82  83  86  87  89
  92  93  96  98  99 100 107 108 109 110 114] are constant.
  warnings.warn("Features \%s are constant." \% constant\_features\_idx,
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(67395, 13)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{get-the-features-that-were-selected-u2r}{%
\subsubsection{Get the features that were selected:
U2R}\label{get-the-features-that-were-selected-u2r}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{true}\PY{o}{=}\PY{n}{selector}\PY{o}{.}\PY{n}{get\PYZus{}support}\PY{p}{(}\PY{p}{)}
\PY{n}{newcolindex\PYZus{}U2R}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{newcolname\PYZus{}U2R}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(} \PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{newcolindex\PYZus{}U2R}\PY{p}{)}
\PY{n}{newcolname\PYZus{}U2R}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
['urgent',
 'hot',
 'root\_shell',
 'num\_file\_creations',
 'num\_shells',
 'srv\_diff\_host\_rate',
 'dst\_host\_count',
 'dst\_host\_srv\_count',
 'dst\_host\_same\_src\_port\_rate',
 'dst\_host\_srv\_diff\_host\_rate',
 'service\_ftp\_data',
 'service\_http',
 'service\_telnet']
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{summary-of-features-selected-by-univariate-feature-selection}{%
\section{Summary of features selected by Univariate Feature
Selection}\label{summary-of-features-selected-by-univariate-feature-selection}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for DoS:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{newcolname\PYZus{}DoS}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for Probe:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{newcolname\PYZus{}Probe}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for R2L:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{newcolname\PYZus{}R2L}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for U2R:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{newcolname\PYZus{}U2R}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Features selected for DoS: ['logged\_in', 'count', 'serror\_rate',
'srv\_serror\_rate', 'same\_srv\_rate', 'dst\_host\_count', 'dst\_host\_srv\_count',
'dst\_host\_same\_srv\_rate', 'dst\_host\_serror\_rate', 'dst\_host\_srv\_serror\_rate',
'service\_http', 'flag\_S0', 'flag\_SF']

Features selected for Probe: ['logged\_in', 'rerror\_rate', 'srv\_rerror\_rate',
'dst\_host\_srv\_count', 'dst\_host\_diff\_srv\_rate', 'dst\_host\_same\_src\_port\_rate',
'dst\_host\_srv\_diff\_host\_rate', 'dst\_host\_rerror\_rate',
'dst\_host\_srv\_rerror\_rate', 'Protocol\_type\_icmp', 'service\_eco\_i',
'service\_private', 'flag\_SF']

Features selected for R2L: ['src\_bytes', 'dst\_bytes', 'hot',
'num\_failed\_logins', 'is\_guest\_login', 'dst\_host\_srv\_count',
'dst\_host\_same\_src\_port\_rate', 'dst\_host\_srv\_diff\_host\_rate', 'service\_ftp',
'service\_ftp\_data', 'service\_http', 'service\_imap4', 'flag\_RSTO']

Features selected for U2R: ['urgent', 'hot', 'root\_shell', 'num\_file\_creations',
'num\_shells', 'srv\_diff\_host\_rate', 'dst\_host\_count', 'dst\_host\_srv\_count',
'dst\_host\_same\_src\_port\_rate', 'dst\_host\_srv\_diff\_host\_rate',
'service\_ftp\_data', 'service\_http', 'service\_telnet']
    \end{Verbatim}

    \hypertarget{the-authors-state-that-after-obtaining-the-adequate-number-of-features-during-the-univariate-selection-process-a-recursive-feature-elimination-rfe-was-operated-with-the-number-of-features-passed-as-parameter-to-identify-the-features-selected.-this-either-implies-that-rfe-is-only-used-for-obtaining-the-features-previously-selected-but-also-obtaining-the-rank.-this-use-of-rfe-is-however-very-redundant-as-the-features-selected-can-be-obtained-in-another-way-done-in-this-project.-one-can-also-not-say-that-the-features-were-selected-by-rfe-as-it-was-not-used-for-this.-the-quote-could-however-also-imply-that-only-the-number-13-from-univariate-feature-selection-was-used.-rfe-is-then-used-for-feature-selection-trying-to-find-the-best-13-features.-with-this-use-of-rfe-one-can-actually-say-that-it-was-used-for-feature-selection.-however-the-authors-obtained-different-numbers-of-features-for-every-attack-category-12-for-dos-15-for-probe-13-for-r2l-and-11-for-u2r.-this-concludes-that-it-is-not-clear-what-mechanism-is-used-for-feature-selection.}{%
\subsection{The authors state that ``After obtaining the adequate number
of features during the univariate selection process, a recursive feature
elimination (RFE) was operated with the number of features passed as
parameter to identify the features selected''. This either implies that
RFE is only used for obtaining the features previously selected but also
obtaining the rank. This use of RFE is however very redundant as the
features selected can be obtained in another way (Done in this project).
One can also not say that the features were selected by RFE, as it was
not used for this. The quote could however also imply that only the
number 13 from univariate feature selection was used. RFE is then used
for feature selection trying to find the best 13 features. With this use
of RFE one can actually say that it was used for feature selection.
However the authors obtained different numbers of features for every
attack category, 12 for DoS, 15 for Probe, 13 for R2L and 11 for U2R.
This concludes that it is not clear what mechanism is used for feature
selection.}\label{the-authors-state-that-after-obtaining-the-adequate-number-of-features-during-the-univariate-selection-process-a-recursive-feature-elimination-rfe-was-operated-with-the-number-of-features-passed-as-parameter-to-identify-the-features-selected.-this-either-implies-that-rfe-is-only-used-for-obtaining-the-features-previously-selected-but-also-obtaining-the-rank.-this-use-of-rfe-is-however-very-redundant-as-the-features-selected-can-be-obtained-in-another-way-done-in-this-project.-one-can-also-not-say-that-the-features-were-selected-by-rfe-as-it-was-not-used-for-this.-the-quote-could-however-also-imply-that-only-the-number-13-from-univariate-feature-selection-was-used.-rfe-is-then-used-for-feature-selection-trying-to-find-the-best-13-features.-with-this-use-of-rfe-one-can-actually-say-that-it-was-used-for-feature-selection.-however-the-authors-obtained-different-numbers-of-features-for-every-attack-category-12-for-dos-15-for-probe-13-for-r2l-and-11-for-u2r.-this-concludes-that-it-is-not-clear-what-mechanism-is-used-for-feature-selection.}}

\hypertarget{to-procede-with-the-data-mining-the-second-option-is-considered-as-this-uses-rfe.-from-now-on-the-number-of-features-for-every-attack-category-is-13.}{%
\subsection{To procede with the data mining, the second option is
considered as this uses RFE. From now on the number of features for
every attack category is
13.}\label{to-procede-with-the-data-mining-the-second-option-is-considered-as-this-uses-rfe.-from-now-on-the-number-of-features-for-every-attack-category-is-13.}}

    \hypertarget{recursive-feature-elimination-for-feature-ranking-option-1-get-importance-from-previous-selected}{%
\section{2. Recursive Feature Elimination for feature ranking (Option 1:
get importance from previous
selected)}\label{recursive-feature-elimination-for-feature-ranking-option-1-get-importance-from-previous-selected}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k+kn}{import} \PY{n}{RFE}
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k+kn}{import} \PY{n}{DecisionTreeClassifier}
\PY{c+c1}{\PYZsh{} Create a decision tree classifier. By convention, clf means \PYZsq{}classifier\PYZsq{}}
\PY{n}{clf} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}

\PY{c+c1}{\PYZsh{}rank all features, i.e continue the elimination until the last one}
\PY{n}{rfe} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{clf}\PY{p}{,} \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}newDoS}\PY{p}{,} \PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{DoS Features sorted by their rank:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{rfe}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{newcolname\PYZus{}DoS}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
DoS Features sorted by their rank:
[(1, 'same\_srv\_rate'), (2, 'count'), (3, 'flag\_SF'), (4,
'dst\_host\_serror\_rate'), (5, 'dst\_host\_same\_srv\_rate'), (6,
'dst\_host\_srv\_count'), (7, 'dst\_host\_count'), (8, 'logged\_in'), (9,
'serror\_rate'), (10, 'dst\_host\_srv\_serror\_rate'), (11, 'srv\_serror\_rate'), (12,
'service\_http'), (13, 'flag\_S0')]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}newProbe}\PY{p}{,} \PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Probe Features sorted by their rank:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{rfe}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{newcolname\PYZus{}Probe}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Probe Features sorted by their rank:
[(1, 'dst\_host\_same\_src\_port\_rate'), (2, 'dst\_host\_srv\_count'), (3,
'dst\_host\_rerror\_rate'), (4, 'service\_private'), (5, 'logged\_in'), (6,
'dst\_host\_diff\_srv\_rate'), (7, 'dst\_host\_srv\_diff\_host\_rate'), (8, 'flag\_SF'),
(9, 'service\_eco\_i'), (10, 'rerror\_rate'), (11, 'Protocol\_type\_icmp'), (12,
'dst\_host\_srv\_rerror\_rate'), (13, 'srv\_rerror\_rate')]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}newR2L}\PY{p}{,} \PY{n}{Y\PYZus{}R2L}\PY{p}{)}
 
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{R2L Features sorted by their rank:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{rfe}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{newcolname\PYZus{}R2L}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
R2L Features sorted by their rank:
[(1, 'src\_bytes'), (2, 'dst\_bytes'), (3, 'hot'), (4,
'dst\_host\_srv\_diff\_host\_rate'), (5, 'service\_ftp\_data'), (6,
'dst\_host\_same\_src\_port\_rate'), (7, 'dst\_host\_srv\_count'), (8,
'num\_failed\_logins'), (9, 'service\_imap4'), (10, 'is\_guest\_login'), (11,
'service\_ftp'), (12, 'flag\_RSTO'), (13, 'service\_http')]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}newU2R}\PY{p}{,} \PY{n}{Y\PYZus{}U2R}\PY{p}{)}
 
\PY{n+nb}{print} \PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{U2R Features sorted by their rank:}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\PY{n+nb}{print} \PY{p}{(}\PY{n+nb}{sorted}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{round}\PY{p}{(}\PY{n}{x}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}\PY{p}{,} \PY{n}{rfe}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{)}\PY{p}{,} \PY{n}{newcolname\PYZus{}U2R}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
U2R Features sorted by their rank:
[(1, 'hot'), (2, 'dst\_host\_srv\_count'), (3, 'dst\_host\_count'), (4,
'root\_shell'), (5, 'num\_shells'), (6, 'service\_ftp\_data'), (7,
'dst\_host\_srv\_diff\_host\_rate'), (8, 'num\_file\_creations'), (9,
'dst\_host\_same\_src\_port\_rate'), (10, 'service\_telnet'), (11,
'srv\_diff\_host\_rate'), (12, 'service\_http'), (13, 'urgent')]
    \end{Verbatim}

    \hypertarget{recursive-feature-elimination-select-13-features-each-of-122-option-2-get-13-best-features-from-122-from-rfe}{%
\section{2. Recursive Feature Elimination, select 13 features each of
122 (Option 2: get 13 best features from 122 from
RFE)}\label{recursive-feature-elimination-select-13-features-each-of-122-option-2-get-13-best-features-from-122-from-rfe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k+kn}{import} \PY{n}{RFE}
\PY{n}{clf} \PY{o}{=} \PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{rfe} \PY{o}{=} \PY{n}{RFE}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{clf}\PY{p}{,} \PY{n}{n\PYZus{}features\PYZus{}to\PYZus{}select}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{,} \PY{n}{step}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{,} \PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n}{X\PYZus{}rfeDoS}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{)}
\PY{n}{true}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{support\PYZus{}}
\PY{n}{rfecolindex\PYZus{}DoS}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{rfecolname\PYZus{}DoS}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{rfecolindex\PYZus{}DoS}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{,} \PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n}{X\PYZus{}rfeProbe}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{)}
\PY{n}{true}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{support\PYZus{}}
\PY{n}{rfecolindex\PYZus{}Probe}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{rfecolname\PYZus{}Probe}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{rfecolindex\PYZus{}Probe}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}R2L}\PY{p}{,} \PY{n}{Y\PYZus{}R2L}\PY{p}{)}
\PY{n}{X\PYZus{}rfeR2L}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}R2L}\PY{p}{)}
\PY{n}{true}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{support\PYZus{}}
\PY{n}{rfecolindex\PYZus{}R2L}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{rfecolname\PYZus{}R2L}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{rfecolindex\PYZus{}R2L}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{38}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{rfe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}U2R}\PY{p}{,} \PY{n}{Y\PYZus{}U2R}\PY{p}{)}
\PY{n}{X\PYZus{}rfeU2R}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{transform}\PY{p}{(}\PY{n}{X\PYZus{}U2R}\PY{p}{)}
\PY{n}{true}\PY{o}{=}\PY{n}{rfe}\PY{o}{.}\PY{n}{support\PYZus{}}
\PY{n}{rfecolindex\PYZus{}U2R}\PY{o}{=}\PY{p}{[}\PY{n}{i} \PY{k}{for} \PY{n}{i}\PY{p}{,} \PY{n}{x} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{true}\PY{p}{)} \PY{k}{if} \PY{n}{x}\PY{p}{]}
\PY{n}{rfecolname\PYZus{}U2R}\PY{o}{=}\PY{n+nb}{list}\PY{p}{(}\PY{n}{colNames}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n}{rfecolindex\PYZus{}U2R}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{summary-of-features-selected-by-rfe}{%
\section{Summary of features selected by
RFE}\label{summary-of-features-selected-by-rfe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{39}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for DoS:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{rfecolname\PYZus{}DoS}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for Probe:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{rfecolname\PYZus{}Probe}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for R2L:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{rfecolname\PYZus{}R2L}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Features selected for U2R:}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{rfecolname\PYZus{}U2R}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Features selected for DoS: ['src\_bytes', 'dst\_bytes', 'wrong\_fragment',
'num\_compromised', 'same\_srv\_rate', 'diff\_srv\_rate', 'dst\_host\_count',
'dst\_host\_same\_srv\_rate', 'dst\_host\_serror\_rate', 'dst\_host\_srv\_serror\_rate',
'service\_ecr\_i', 'flag\_RSTR', 'flag\_S0']

Features selected for Probe: ['src\_bytes', 'dst\_bytes', 'rerror\_rate',
'dst\_host\_same\_srv\_rate', 'dst\_host\_diff\_srv\_rate',
'dst\_host\_same\_src\_port\_rate', 'dst\_host\_rerror\_rate', 'service\_finger',
'service\_ftp\_data', 'service\_http', 'service\_private', 'service\_smtp',
'service\_telnet']

Features selected for R2L: ['duration', 'src\_bytes', 'dst\_bytes', 'hot',
'num\_failed\_logins', 'num\_access\_files', 'dst\_host\_count', 'dst\_host\_srv\_count',
'dst\_host\_same\_srv\_rate', 'dst\_host\_same\_src\_port\_rate',
'dst\_host\_srv\_diff\_host\_rate', 'service\_ftp\_data', 'service\_imap4']

Features selected for U2R: ['duration', 'src\_bytes', 'dst\_bytes', 'hot',
'root\_shell', 'num\_file\_creations', 'num\_shells', 'srv\_count', 'dst\_host\_count',
'dst\_host\_same\_srv\_rate', 'dst\_host\_srv\_diff\_host\_rate', 'service\_ftp\_data',
'service\_other']
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{40}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}rfeDoS}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}rfeProbe}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}rfeR2L}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{n}{X\PYZus{}rfeU2R}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
(113270, 13)
(78999, 13)
(68338, 13)
(67395, 13)
    \end{Verbatim}

    \hypertarget{step-4-build-the-model}{%
\section{Step 4: Build the model:}\label{step-4-build-the-model}}

\hypertarget{classifier-is-trained-for-all-features-and-for-reduced-features-for-later-comparison.}{%
\subsubsection{Classifier is trained for all features and for reduced
features, for later
comparison.}\label{classifier-is-trained-for-all-features-and-for-reduced-features-for-later-comparison.}}

\hypertarget{the-classifier-model-itself-is-stored-in-the-clf-variable.}{%
\paragraph{The classifier model itself is stored in the clf
variable.}\label{the-classifier-model-itself-is-stored-in-the-clf-variable.}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} all features}
\PY{n}{clf\PYZus{}DoS}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}Probe}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}R2L}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}U2R}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}DoS}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}DoS}\PY{p}{,} \PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n}{clf\PYZus{}Probe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}Probe}\PY{p}{,} \PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n}{clf\PYZus{}R2L}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}R2L}\PY{p}{,} \PY{n}{Y\PYZus{}R2L}\PY{p}{)}
\PY{n}{clf\PYZus{}U2R}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}U2R}\PY{p}{,} \PY{n}{Y\PYZus{}U2R}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{41}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeClassifier(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} selected features}
\PY{n}{clf\PYZus{}rfeDoS}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeProbe}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeR2L}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeU2R}\PY{o}{=}\PY{n}{DecisionTreeClassifier}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeDoS}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}rfeDoS}\PY{p}{,} \PY{n}{Y\PYZus{}DoS}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeProbe}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}rfeProbe}\PY{p}{,} \PY{n}{Y\PYZus{}Probe}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeR2L}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}rfeR2L}\PY{p}{,} \PY{n}{Y\PYZus{}R2L}\PY{p}{)}
\PY{n}{clf\PYZus{}rfeU2R}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{X\PYZus{}rfeU2R}\PY{p}{,} \PY{n}{Y\PYZus{}U2R}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{42}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
DecisionTreeClassifier(random\_state=0)
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{step-5-prediction-evaluation-validation}{%
\section{Step 5: Prediction \& Evaluation
(validation):}\label{step-5-prediction-evaluation-validation}}

    \hypertarget{using-all-features-for-each-category}{%
\section{Using all Features for each
category}\label{using-all-features-for-each-category}}

    \hypertarget{confusion-matrices}{%
\section{Confusion Matrices}\label{confusion-matrices}}

\hypertarget{dos}{%
\subsection{DoS}\label{dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} Apply the classifier we trained to the test data (which it has never seen before)}
\PY{n}{clf\PYZus{}DoS}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{43}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([1, 1, 0, {\ldots}, 0, 0, 0])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} View the predicted probabilities of the first 10 observations}
\PY{n}{clf\PYZus{}DoS}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{44}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
array([[0., 1.],
       [0., 1.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [1., 0.],
       [0., 1.],
       [1., 0.],
       [1., 0.]])
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{o}{=}\PY{n}{clf\PYZus{}DoS}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{45}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks     0     1
Actual attacks
0                  9499   212
1                  2830  4630
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{probe}{%
\subsection{Probe}\label{probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{=}\PY{n}{clf\PYZus{}Probe}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{46}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks     0     2
Actual attacks
0                  2337  7374
2                   212  2209
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{r2l}{%
\subsection{R2L}\label{r2l}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}R2L\PYZus{}pred}\PY{o}{=}\PY{n}{clf\PYZus{}R2L}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}R2L\PYZus{}test}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}R2L\PYZus{}pred}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{47}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks     0    3
Actual attacks
0                  9707    4
3                  2573  312
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{u2r}{%
\subsection{U2R}\label{u2r}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}U2R\PYZus{}pred}\PY{o}{=}\PY{n}{clf\PYZus{}U2R}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}U2R\PYZus{}test}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}U2R\PYZus{}pred}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{48}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks     0  4
Actual attacks
0                  9703  8
4                    60  7
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{accuracy-precision-recall-f-measure}{%
\section{Accuracy, Precision, Recall,
F-measure}\label{accuracy-precision-recall-f-measure}}

    TP = True Positive, TN = True Negative, FP = False Positive, FN = False
Negative

accuracy = (TP + TN) / (TP + TN + FP + FN)

precision = TP / (FP + TP)

recall = TP / (TP + FN)

f = (2 * precision * recall) / (precision + recall)

    \hypertarget{dos}{%
\subsection{DoS}\label{dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{metrics}
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.82284
Precision: 0.95622
Recall: 0.62064
F-measure: 0.75272
    \end{Verbatim}

    \hypertarget{probe}{%
\section{Probe}\label{probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.37471
Precision: 0.23051
Recall: 0.91243
F-measure: 0.36804
    \end{Verbatim}

    \hypertarget{r2l}{%
\subsection{R2L}\label{r2l}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}R2L\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}R2L\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}R2L\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}R2L\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.79541
Precision: 0.98734
Recall: 0.10815
F-measure: 0.19494
    \end{Verbatim}

    \hypertarget{u2r}{%
\subsection{U2R}\label{u2r}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}U2R\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}U2R\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}U2R\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}U2R\PYZus{}pred}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.99305
Precision: 0.46667
Recall: 0.10448
F-measure: 0.17073
    \end{Verbatim}

    \hypertarget{using-13-features-for-each-category}{%
\section{Using 13 Features for each
category}\label{using-13-features-for-each-category}}

    \hypertarget{confusion-matrices}{%
\section{Confusion Matrices}\label{confusion-matrices}}

\hypertarget{dos}{%
\subsection{DoS}\label{dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{62}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{c+c1}{\PYZsh{} reduce test dataset to 13 features, use only features described in rfecolname\PYZus{}DoS etc.}
\PY{n}{X\PYZus{}DoS\PYZus{}test2}\PY{o}{=}\PY{n}{X\PYZus{}DoS\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{rfecolindex\PYZus{}DoS}\PY{p}{]}
\PY{n}{X\PYZus{}Probe\PYZus{}test2}\PY{o}{=}\PY{n}{X\PYZus{}Probe\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{rfecolindex\PYZus{}Probe}\PY{p}{]}
\PY{n}{X\PYZus{}R2L\PYZus{}test2}\PY{o}{=}\PY{n}{X\PYZus{}R2L\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{rfecolindex\PYZus{}R2L}\PY{p}{]}
\PY{n}{X\PYZus{}U2R\PYZus{}test2}\PY{o}{=}\PY{n}{X\PYZus{}U2R\PYZus{}test}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{n}{rfecolindex\PYZus{}U2R}\PY{p}{]}
\PY{n}{X\PYZus{}U2R\PYZus{}test2}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{62}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(9778, 13)
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{o}{=}\PY{n}{clf\PYZus{}rfeDoS}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}DoS\PYZus{}test2}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{63}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks     0     1
Actual attacks
0                  9602   109
1                  2625  4835
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{probe}{%
\subsection{Probe}\label{probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{64}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{=}\PY{n}{clf\PYZus{}rfeProbe}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}Probe\PYZus{}test2}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{64}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks     0     2
Actual attacks
0                  8709  1002
2                   944  1477
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{r2l}{%
\subsection{R2L}\label{r2l}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}R2L\PYZus{}pred2}\PY{o}{=}\PY{n}{clf\PYZus{}rfeR2L}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}R2L\PYZus{}test2}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}R2L\PYZus{}pred2}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{65}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks     0    3
Actual attacks
0                  9649   62
3                  2560  325
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{u2r}{%
\subsection{U2R}\label{u2r}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Y\PYZus{}U2R\PYZus{}pred2}\PY{o}{=}\PY{n}{clf\PYZus{}rfeU2R}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{X\PYZus{}U2R\PYZus{}test2}\PY{p}{)}
\PY{c+c1}{\PYZsh{} Create confusion matrix}
\PY{n}{pd}\PY{o}{.}\PY{n}{crosstab}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{p}{,} \PY{n}{Y\PYZus{}U2R\PYZus{}pred2}\PY{p}{,} \PY{n}{rownames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Actual attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{colnames}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Predicted attacks}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{66}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Predicted attacks     0   4
Actual attacks
0                  9706   5
4                    52  15
\end{Verbatim}
\end{tcolorbox}
        
    \hypertarget{accuracy-precision-recall-f-measure}{%
\section{Accuracy, Precision, Recall,
F-measure}\label{accuracy-precision-recall-f-measure}}

    TP = True Positive, TN = True Negative, FP = False Positive, FN = False
Negative

accuracy = (TP + TN) / (TP + TN + FP + FN)

precision = TP / (FP + TP)

recall = TP / (TP + FN)

f = (2 * precision * recall) / (precision + recall)

    \hypertarget{dos}{%
\subsection{DoS}\label{dos}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{49}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k+kn}{import} \PY{n}{metrics}
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}DoS\PYZus{}test}\PY{p}{,}\PY{n}{Y\PYZus{}DoS\PYZus{}pred2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.82284
Precision: 0.95622
Recall: 0.62064
F-measure: 0.75272
    \end{Verbatim}

    \hypertarget{probe}{%
\section{Probe}\label{probe}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{50}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}Probe\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{,}\PY{n}{Y\PYZus{}Probe\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{2}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.37471
Precision: 0.23051
Recall: 0.91243
F-measure: 0.36804
    \end{Verbatim}

    \hypertarget{r2l}{%
\subsection{R2L}\label{r2l}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{51}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}R2L\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}R2L\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}R2L\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}R2L\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{,}\PY{n}{Y\PYZus{}R2L\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{3}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.79541
Precision: 0.98734
Recall: 0.10815
F-measure: 0.19494
    \end{Verbatim}

    \hypertarget{u2r}{%
\subsection{U2R}\label{u2r}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{52}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{accuracy} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{accuracy\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}U2R\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Accuracy: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{accuracy}\PY{p}{)}
\PY{n}{precision} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{precision\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}U2R\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Precision: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{precision}\PY{p}{)}
\PY{n}{recall} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{recall\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}U2R\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Recall: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{recall}\PY{p}{)}
\PY{n}{f} \PY{o}{=} \PY{n}{metrics}\PY{o}{.}\PY{n}{f1\PYZus{}score}\PY{p}{(}\PY{n}{Y\PYZus{}U2R\PYZus{}test}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Y\PYZus{}U2R\PYZus{}pred2}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{F\PYZhy{}measure: }\PY{l+s+si}{\PYZpc{}0.5f}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
Accuracy: 0.99305
Precision: 0.46667
Recall: 0.10448
F-measure: 0.17073
    \end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
